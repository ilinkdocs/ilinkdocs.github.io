"use strict";(self.webpackChunkilink=self.webpackChunkilink||[]).push([[602],{7462:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>r,contentTitle:()=>d,default:()=>m,frontMatter:()=>t,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"webhooks-ilink","title":"Webhooks ilink","description":"\xc2mbito","source":"@site/docs/webhooks-ilink.md","sourceDirName":".","slug":"/webhooks-ilink","permalink":"/webhooks-ilink","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"ilinkSidebar","previous":{"title":"Integra\xe7\xe3o via AS2","permalink":"/integracao-as2"},"next":{"title":"Onboarding FEAP","permalink":"/onboarding-feap"}}');var s=n(4848),i=n(8453);const t={sidebar_position:6},d="Webhooks ilink",r={},c=[{value:"\xc2mbito",id:"\xe2mbito",level:2},{value:"Informa\xe7\xe3o importante / Implica\xe7\xf5es de Seguran\xe7a",id:"informa\xe7\xe3o-importante--implica\xe7\xf5es-de-seguran\xe7a",level:2},{value:"Webhooks",id:"webhooks",level:2},{value:"Webhook de novo documento",id:"webhook-de-novo-documento",level:3},{value:"Webhook de mudan\xe7a de estado de documento",id:"webhook-de-mudan\xe7a-de-estado-de-documento",level:3}];function l(e){const o={a:"a",blockquote:"blockquote",code:"code",del:"del",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"webhooks-ilink",children:"Webhooks ilink"})}),"\n",(0,s.jsx)(o.h2,{id:"\xe2mbito",children:"\xc2mbito"}),"\n",(0,s.jsx)(o.p,{children:"Neste modelo de comunica\xe7\xe3o, o ilink toma a iniciativa de comunicar ao ERP no momento que um determinado evento ocorre, dispensando de consultas frequentes ao nosso API."}),"\n",(0,s.jsx)(o.p,{children:"O ilink disponibiliza 2 webhooks:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Webhook de novo documento"})," - enviado ao receptor cada vez que um novo documento lhe \xe9 encaminhado"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Webhook de mudan\xe7a de estado de documento"})," - enviado ao emissor cada vez que um documento previamente emitido altera o seu estado"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"Para qualquer dos webhooks acima funcionar \xe9 necess\xe1rio:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Implementar um endpoint Web, ",(0,s.jsx)(o.strong,{children:"dispon\xedvel publicamente aos servidores do ilink"}),", ao qual o ilink ir\xe1 comunicar via ",(0,s.jsx)(o.strong,{children:"HTTP"}),". Os dados enviados do ilink para este URL p\xfablico est\xe3o de acordo com o webhook que pretendem implementar (ver abaixo)"]}),"\n",(0,s.jsxs)(o.li,{children:["Comunicar \xe0 equipa do ilink que pretendem implementar o Webhook espec\xedfico para o vosso cliente, e indicar-nos uma ",(0,s.jsx)(o.strong,{children:"chave de acesso"})," e o ",(0,s.jsx)(o.strong,{children:"URL p\xfablico"})," do vosso endpoint."]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["Este m\xe9todo, apesar de implementa\xe7\xe3o mais extensa, tem a vantagem de evitar ",(0,s.jsx)(o.a,{href:"https://en.wikipedia.org/wiki/Polling_%28computer_science%29",children:"polling"})," constante aos nossos servidores, consumir menos recursos em ambos os sistemas, e permite aceder a toda a informa\xe7\xe3o em tempo real. S\xf3 recomendamos optar pela consulta manual caso existam implica\xe7\xf5es de seguran\xe7a na abordagem dos Webhooks (ver abaixo)."]}),"\n",(0,s.jsx)(o.h2,{id:"informa\xe7\xe3o-importante--implica\xe7\xf5es-de-seguran\xe7a",children:"Informa\xe7\xe3o importante / Implica\xe7\xf5es de Seguran\xe7a"}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Esta op\xe7\xe3o assume que o URL/porta em quest\xe3o est\xe1 dispon\xedvel publicamente, ou pelo menos acess\xedvel aos nossos ambientes de testes e produ\xe7\xe3o!"})," Para tal, poder\xe1 ser necess\xe1rio abrir portas ou criar as seguintes excep\xe7\xf5es no firewall da m\xe1quina que executa o servi\xe7o web:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.a,{href:"https://ilink.acin.pt",children:"https://ilink.acin.pt"})," (62.28.56.162:443) - testes"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.a,{href:"https://ilink.pt",children:"https://ilink.pt"})," (",(0,s.jsx)(o.del,{children:"194.38.136.153:443"})," 193.43.40.153:443) - produ\xe7\xe3o"]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["Caso falhe o processo de comunica\xe7\xe3o de um documento, o ilink ir\xe1 tentar comunicar novamente ",(0,s.jsx)(o.strong,{children:"at\xe9 10 vezes nos pr\xf3ximos 7 dias"}),", com intervalos incrementalmente maiores por cada tentativa. Ap\xf3s 10 tentativas falhadas de comunica\xe7\xe3o, o ilink ir\xe1 deixar de tentar comunicar esse documento ao ERP."]}),"\n",(0,s.jsxs)(o.p,{children:["Um documento \xe9 considerado entregue com sucesso ao ERP quando a reposta do webhook retorna um ",(0,s.jsx)(o.strong,{children:"HTTP status code 200"})," (independentemente do conte\xfado da resposta)."]}),"\n",(0,s.jsxs)(o.blockquote,{children:["\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Importante"}),": Na implementa\xe7\xe3o deste endpoint, o ERP tem a responsabilidade de validar a chave de acesso e posteriormente registar a informa\xe7\xe3o recebida no seu sistema. Recomendamos vivamente ao vosso sistema validar a chave de acesso enviada nos headers da nossa resposta, caso contr\xe1rio est\xe3o a aceitar dados provenientes de origem desconhecida. O ilink envia a vossa chave no header ",(0,s.jsx)(o.code,{children:"Authorization: Bearer {CHAVE_INTEGRACAO}"}),"."]}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"webhooks",children:"Webhooks"}),"\n",(0,s.jsx)(o.h3,{id:"webhook-de-novo-documento",children:"Webhook de novo documento"}),"\n",(0,s.jsx)(o.p,{children:"O webhook de novo documento \xe9 uma alternativa \xe0 consulta frequente de documentos por parte da entidade receptora. Cada vez que chega um novo documento a esta entidade, o callback de novo documento ser\xe1 invocado."}),"\n",(0,s.jsxs)(o.p,{children:["O endpoint implementado dever\xe1 esperar os seguintes dados desta ",(0,s.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Webhooks/documentReceivedWebhook",children:"especifica\xe7\xe3o"}),"."]}),"\n",(0,s.jsx)(o.h3,{id:"webhook-de-mudan\xe7a-de-estado-de-documento",children:"Webhook de mudan\xe7a de estado de documento"}),"\n",(0,s.jsx)(o.p,{children:"O webhook de mudan\xe7a de estado de documento \xe9 uma alternativa \xe0 consulta frequente dos estados de cada documento emitido por parte da entidade emissora. Cada vez que o receptor do um documento emitido aceitar, recusar ou receber o mesmo, este callback ser\xe1 invocado."}),"\n",(0,s.jsxs)(o.p,{children:["O endpoint implementado dever\xe1 esperar os seguintes dados desta ",(0,s.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Webhooks/webhookDocumentState",children:"especifica\xe7\xe3o"}),"."]})]})}function m(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,o,n)=>{n.d(o,{R:()=>t,x:()=>d});var a=n(6540);const s={},i=a.createContext(s);function t(e){const o=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),a.createElement(i.Provider,{value:o},e.children)}}}]);