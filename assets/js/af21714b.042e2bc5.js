"use strict";(self.webpackChunkilink=self.webpackChunkilink||[]).push([[967],{2463:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>r,contentTitle:()=>t,default:()=>m,frontMatter:()=>d,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"integrations/api/received","title":"Rece\xe7\xe3o de documentos","description":"\xc2mbito","source":"@site/docs/integrations/api/received.md","sourceDirName":"integrations/api","slug":"/integrations/api/received","permalink":"/docs/integrations/api/received","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ilinkSidebar","previous":{"title":"Emiss\xe3o de documentos","permalink":"/docs/integrations/api/issued"},"next":{"title":"Casos de uso","permalink":"/docs/integrations/api/usecases"}}');var i=s(4848),a=s(8453);const d={},t="Rece\xe7\xe3o de documentos",r={},c=[{value:"\xc2mbito",id:"\xe2mbito",level:2},{value:"M\xe9todos de rece\xe7\xe3o",id:"m\xe9todos-de-rece\xe7\xe3o",level:2},{value:"Consulta manual de documentos",id:"consulta-manual-de-documentos",level:3},{value:"Webhook de rece\xe7\xe3o (recomendado)",id:"webhook-de-rece\xe7\xe3o-recomendado",level:3},{value:"Importa\xe7\xe3o e aceita\xe7\xe3o",id:"importa\xe7\xe3o-e-aceita\xe7\xe3o",level:2},{value:"Estados de Processo (opcional)",id:"estados-de-processo-opcional",level:2}];function l(e){const o={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"rece\xe7\xe3o-de-documentos",children:"Rece\xe7\xe3o de documentos"})}),"\n",(0,i.jsx)(o.h2,{id:"\xe2mbito",children:"\xc2mbito"}),"\n",(0,i.jsx)(o.p,{children:"Esta funcionalidade permite a entrada autom\xe1tica de documentos de fatura\xe7\xe3o no ERP do recetor, simplificando a integra\xe7\xe3o nos sistemas contabil\xedsticos. Tamb\xe9m possibilita comunicar ao emissor os estados de aceita\xe7\xe3o e integra\xe7\xe3o do documento (pago, aceite, recusado, etc.)."}),"\n",(0,i.jsx)(o.p,{children:"Neste fluxo de integra\xe7\xe3o, devem ser implementados os seguintes pontos:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Leitura e processamento de dados"}),": Extrair a informa\xe7\xe3o do XML ou de outros dados estruturados do documento para registar corretamente no ERP"]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Comunica\xe7\xe3o do estado de integra\xe7\xe3o"}),": Informar o ilink sobre o resultado do processo de integra\xe7\xe3o do documento"]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Gest\xe3o do estado de aceita\xe7\xe3o"}),": Comunicar o estado de aceita\xe7\xe3o do documento, incluindo mensagens detalhadas em caso de erro ou rejei\xe7\xe3o"]}),"\n"]}),"\n",(0,i.jsx)(o.h2,{id:"m\xe9todos-de-rece\xe7\xe3o",children:"M\xe9todos de rece\xe7\xe3o"}),"\n",(0,i.jsxs)(o.p,{children:["Permite consultar e integrar documentos no sistema. A rece\xe7\xe3o pode ser feita de duas formas: ",(0,i.jsx)(o.strong,{children:"Consulta manual de documentos"})," ou ",(0,i.jsx)(o.strong,{children:"Webhook de rece\xe7\xe3o"}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"consulta-manual-de-documentos",children:"Consulta manual de documentos"}),"\n",(0,i.jsxs)(o.p,{children:["Neste modo, \xe9 necess\xe1rio aceder ao endpoint ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocuments",children:"GET /apps/documents"})}),". \xc9 poss\xedvel indicar par\xe2metros de pesquisa para filtrar os resultados. A resposta inclui os dados principais dos documentos e informa\xe7\xe3o de pagina\xe7\xe3o atrav\xe9s das propriedades ",(0,i.jsx)(o.code,{children:"rows"})," (n\xfamero de elementos por p\xe1gina) e ",(0,i.jsx)(o.code,{children:"page"})," (n\xfamero da p\xe1gina)."]}),"\n",(0,i.jsxs)(o.p,{children:["Para consultar os detalhes de um documento e aceder aos ficheiros XML e PDF, deve ser usado o m\xe9todo ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocument",children:"GET /apps/documents/{id}"})}),", recorrendo a um dos ",(0,i.jsx)(o.code,{children:"id"}),"s obtidos na listagem anterior."]}),"\n",(0,i.jsx)(o.p,{children:"O endpoint pode ser chamado periodicamente (processo em segundo plano) ou por a\xe7\xe3o de um utilizador no sistema (em tempo real)."}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Nota:"})," A chave p\xfablica aqui usada corresponde \xe0 entidade recetora dos documentos. Deve ser utilizada a chave que identifica quem acede aos documentos recebidos."]}),"\n"]}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Importante:"})," O uso excessivo deste endpoint deve ser evitado. Chamadas em demasia podem originar ",(0,i.jsx)(o.em,{children:"timeouts"})," ou restri\xe7\xf5es de acesso, de acordo com o acordo de interoperabilidade."]}),"\n"]}),"\n",(0,i.jsx)(o.h3,{id:"webhook-de-rece\xe7\xe3o-recomendado",children:"Webhook de rece\xe7\xe3o (recomendado)"}),"\n",(0,i.jsxs)(o.p,{children:["Neste modo, o ilink notifica o ERP sempre que chega um novo documento, dispensando consultas frequentes ao endpoint ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocuments",children:"GET /apps/documents"})}),". Para mais informa\xe7\xe3o, ver a sec\xe7\xe3o ",(0,i.jsx)(o.a,{href:"/docs/integrations/webhooks/intro",children:"Webhooks"}),"."]}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Nota:"})," S\xe3o enviados os dados dos documentos num formato estruturado, incluindo URLs de acesso aos anexos XML e PDF."]}),"\n"]}),"\n",(0,i.jsx)(o.h2,{id:"importa\xe7\xe3o-e-aceita\xe7\xe3o",children:"Importa\xe7\xe3o e aceita\xe7\xe3o"}),"\n",(0,i.jsx)(o.p,{children:"Ap\xf3s consultar o documento, o ERP deve comunicar ao ilink o estado de processamento, ou seja, se foi integrado com sucesso ou se necessita de corre\xe7\xf5es. S\xe3o necess\xe1rios 2 passos:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.strong,{children:"1. Comunicar o estado do documento"})}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["Feito com ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentsAccepted",children:"POST /apps/documents/{id}/accepted"})}),", indicando se o documento foi aceite ou n\xe3o e, em caso de rejei\xe7\xe3o, o motivo"]}),"\n",(0,i.jsx)(o.li,{children:"\xc9 obrigat\xf3rio indicar o motivo de rejei\xe7\xe3o se o documento n\xe3o for aceite"}),"\n",(0,i.jsx)(o.li,{children:"Um documento rejeitado pode ser reenviado pelo emissor com os dados corrigidos"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(o.li,{children:["\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.strong,{children:"2. Comunicar a importa\xe7\xe3o do documento (apenas se aceite)"})}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["Se o passo anterior indicar aceita\xe7\xe3o, deve ser chamado o m\xe9todo ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocuments",children:"POST /apps/documents/{id}"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Nota:"})," Documentos rejeitados n\xe3o devem ser importados."]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["A comunica\xe7\xe3o correta de documentos aceites/importados garante hist\xf3rico de auditoria e facilita o consumo da API. Se estiver a ser usada a consulta manual, documentos j\xe1 rejeitados ou importados n\xe3o voltam a ser devolvidos em chamadas futuras. ",(0,i.jsxs)(o.strong,{children:["Ou seja, o endpoint ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocuments",children:"GET /apps/documents"})})," n\xe3o devolve documentos previamente rejeitados ou importados"]}),"."]}),"\n",(0,i.jsx)(o.p,{children:"A imagem abaixo mostra como as opera\xe7\xf5es feitas pelo ERP ficam registadas no portal do ilink:"}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.img,{alt:"img info",src:s(3584).A+"",width:"1468",height:"500"})}),"\n",(0,i.jsx)(o.p,{children:"O uso correto da importa\xe7\xe3o de documentos gera tamb\xe9m uma informa\xe7\xe3o consult\xe1vel para o fornecedor do documento, ficando confirmada a sua integra\xe7\xe3o com o sistema do recetor."}),"\n",(0,i.jsx)(o.h2,{id:"estados-de-processo-opcional",children:"Estados de Processo (opcional)"}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Nota:"})," Funcionalidade opcional e apenas informativa. N\xe3o interfere com a rece\xe7\xe3o de documentos."]}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"O ilink permite criar estados de documento personalizados. Quando ativa, \xe9 poss\xedvel consultar e modificar o estado de um documento via API. Esta capacidade permite que sistemas externos (ex.: gest\xe3o documental) alterem o estado processual de forma integrada, e \xe9 \xfatil para sincronizar processos internos da organiza\xe7\xe3o entre sistemas. Todas as altera\xe7\xf5es de estado de processo ficam registadas no hist\xf3rico do documento."}),"\n",(0,i.jsxs)(o.blockquote,{children:["\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.strong,{children:"Importante:"})," O estado de processo \xe9 independente do estado base (recebido, aceite, etc.). Serve apenas para organiza\xe7\xe3o interna e registo de opera\xe7\xf5es."]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Para consultar os estados dispon\xedveis, use ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Estados%20de%20processamento%20de%20documentos/getProcessStates",children:"GET /apps/processstates"})}),", que devolve a lista completa com respetivo ",(0,i.jsx)(o.code,{children:"identification_code"}),".\nPara alterar o estado de um documento, use ",(0,i.jsx)(o.strong,{children:(0,i.jsx)(o.a,{href:"https://ilink.acin.pt/swagger-ui/dist/index.html#/Estados%20de%20processamento%20de%20documentos/postDocumentsProcessState",children:"PUT /apps/documents/{id}/processstates"})}),", indicando o novo ",(0,i.jsx)(o.code,{children:"identification_code"}),"."]}),"\n",(0,i.jsx)(o.p,{children:"A configura\xe7\xe3o dos estados de processo a usar \xe9 feita pela equipa de apoio do ilink."})]})}function m(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},3584:(e,o,s)=>{s.d(o,{A:()=>n});const n=s.p+"assets/images/20230426-125316-0840655190d4733e042ef2069dda297b.png"},8453:(e,o,s)=>{s.d(o,{R:()=>d,x:()=>t});var n=s(6540);const i={},a=n.createContext(i);function d(e){const o=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(a.Provider,{value:o},e.children)}}}]);