<!doctype html>
<html lang="enGB" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-integrations/api/issued" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Issuing documents | ilink Knowledge Base</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/en/docs/integrations/api/issued"><meta data-rh="true" property="og:locale" content="enGB"><meta data-rh="true" property="og:locale:alternate" content="ptPT"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Issuing documents | ilink Knowledge Base"><meta data-rh="true" name="description" content="Scope"><meta data-rh="true" property="og:description" content="Scope"><link data-rh="true" rel="icon" href="/en/img/favicon.png"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/en/docs/integrations/api/issued"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/integrations/api/issued" hreflang="ptPT"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/en/docs/integrations/api/issued" hreflang="enGB"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/integrations/api/issued" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Issuing documents","item":"https://your-docusaurus-site.example.com/en/docs/integrations/api/issued"}]}</script><link rel="stylesheet" href="/en/assets/css/styles.c09e8c32.css">
<script src="/en/assets/js/runtime~main.61085395.js" defer="defer"></script>
<script src="/en/assets/js/main.dc68fede.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/en/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.png" alt="ilink Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo.png" alt="ilink Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ilink Knowledge Base</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Technical Guides</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/docs/integrations/api/scope">REST API</a></li><li><a class="dropdown__link" href="/en/docs/integrations/webhooks/intro">Webhooks</a></li><li><a class="dropdown__link" href="/en/docs/integrations/as2/intro">AS2</a></li><li><a class="dropdown__link" href="/en/docs/onboarding-feap">FEAP Onboarding</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Integrations</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/docs/guides/main">List of Integrations</a></li><li><a class="dropdown__link" href="/en/docs/guides/moloni">Moloni Integration</a></li><li><a class="dropdown__link" href="/en/docs/guides/medidata">Medidata Integration</a></li></ul></div><a href="https://www.ilink.pt/swagger-ui/dist/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Technical Specification</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/integrations/api/issued" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ptPT">PortuguÃªs</a></li><li><a href="/en/docs/integrations/api/issued" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="enGB">English</a></li></ul></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/">ilink Knowledge Base</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en/docs/integrations/api/scope">IntegraÃ§Ã£o API REST</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/scope">Introduction to the REST API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/specification">Technical Specification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/integrations/api/issued">Issuing documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/received">Receiving documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/usecases">Use Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/flows">API Flows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/integrations/api/checklist">Pre-production checklist</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en/docs/integrations/webhooks/intro">Webhooks ilink</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/en/docs/integrations/as2/intro">IntegraÃ§Ã£o AS2</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/onboarding-feap">FEAP Onboarding</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">IntegraÃ§Ã£o API REST</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Issuing documents</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Issuing documents</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scope">Scope<a href="#scope" class="hash-link" aria-label="Direct link to Scope" title="Direct link to Scope">â</a></h2>
<p>The ilink platform allows integrator systems to issue documents that are automatically sent to their respective recipients. ilink manages the entire sending process for the ERPs and EDIs configured for each customer, making this process transparent for the API. These configurations are carried out by the ilink support team before before deployment to production.</p>
<p>The ilink platform supports the sending of electronic invoices in two different scenarios:</p>
<ul>
<li><strong>Sending signed PDFs via e-mail to end consumers or private companies</strong>
<ul>
<li>In this scenario, it is not necessary to create connections with other EDIs. Simply indicate the destination e-mail address(es) in the document creation endpoint. For more information, see the section <a href="/en/docs/integrations/api/issued#m%C3%A9todos-de-envio">Sending methods</a>.</li>
</ul>
</li>
<li><strong>Sending CIUS-PT XML to public entities (mandatory in public contracts)</strong>
<ul>
<li>In this scenario, it is necessary to configure the connections between TINs in advance and, possibly, between other external EDI brokers.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>How are documents sent to other EDI brokers?</strong>
During the production deployment phase, a survey of all entities that will receive documents via EDI, as well as their respective EDI brokers, must be carried out. Subsequently, the support team (<a href="mailto:apoio@ilink.pt" target="_blank" rel="noopener noreferrer">apoio@ilink.pt</a>) will configure the necessary connections to ensure that the documents are automatically integrated into each recipientâs system. Before sending documents to the FE-AP solution of eSPap, each issuer must also complete the <a href="/en/docs/onboarding-feap">FE-AP supplier enrolment process</a>.</p>
</blockquote>
<p>All documents issued are available on the ilink portal, both for the issuing entity and for the receiving entity.</p>
<blockquote>
<p><strong>Note: In the test environment, you should only issue documents between the two entities that have been granted access</strong>. If you wish to verify the functioning of document sending to an end consumer (arbitrary TIN), you should always issue the document through one of the entities that have been granted access.</p>
</blockquote>
<p><strong>IMPORTANT:</strong> When sending documents to <strong>public entities</strong>, we strongly recommend implementing the following aspects, otherwise you may not be able to integrate the documents with certain systems:</p>
<ul>
<li>Commitment number</li>
<li>Original PDF file of the invoice</li>
<li>Order or requisition number (if applicable)</li>
<li>Supplier&#x27;s share capital</li>
<li>Customer&#x27;s e-mail address (only for the offices of the Regional Government of Madeira)</li>
<li>All supplier address details (street, postal code, city, etc.)</li>
<li>Customer GLN (if applicable)</li>
<li>Possibility of resending the document based on the state obtained (useful for correcting and resending a previously rejected document)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="assinatura-digital">Digital signature<a href="#assinatura-digital" class="hash-link" aria-label="Direct link to Digital signature" title="Direct link to Digital signature">â</a></h2>
<p>Ilink allows you to automatically sign attachments to issued documents (XML and PDF), provided that the issuing entity has purchased and configured a seal from one of the qualified digital signature providers. Currently, only <a href="https://globaltrustedsign.com/" target="_blank" rel="noopener noreferrer">GTS - Global Trusted Sign</a> is supported, but there are plans to support the remaining providers in Portugal.</p>
<p>This means that the ERP is not required to integrate with a signature provider and can (optionally) delegate the certification process to ilink. Alternatively, the ERP itself can perform the certification process and send the signed documents to ilink.</p>
<blockquote>
<p><strong>Note:</strong> <strong>In the ilink signature scenario, by default, all resulting files are signed upon entry (xml and pdf)</strong> and subsequently sent to the customer. This behaviour can be changed, allowing you to define which files are signed. For more information, see the section on <a href="/en/docs/integrations/api/issued#cria%C3%A7%C3%A3o-de-documentos-e-consumo-de-assinaturas-digitais-qualificadas">signature consumption</a>.</p>
</blockquote>
<p><strong>In the case of signing via ERP, the digital signature of the document is always cryptographically validated for all documents entering the system</strong>. A document with an invalid signature, both in XML and PDF, will not integrate and will always return an error via API as follows:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e217&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The signature on the document is not valid.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The previous error indicates that the document has been altered since it was signed, or that the signature was generated incorrectly. The following <a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/validation" target="_blank" rel="noopener noreferrer">validator</a> can be used to verify the validity of document signatures. The signature formats recognised by ilink are  <a href="https://www.adobe.com/uk/acrobat/resources/document-files/pdf-types/pades.html" target="_blank" rel="noopener noreferrer">PADES</a> and PKCS7-B (PDF), or XMLDSig and <a href="https://en.wikipedia.org/wiki/XAdES" target="_blank" rel="noopener noreferrer">XADES-BES</a> (XML).</p>
<blockquote>
<p><strong>Note:</strong> The legal requirements for the signature of electronic invoices are available in <a href="https://dre.pt/home/-/dre/119622094/details/maximized" target="_blank" rel="noopener noreferrer">Decree-Law 28/2019, section II, article 12</a>.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> Ilink signs PDF documents in <a href="https://www.adobe.com/uk/acrobat/resources/document-files/pdf-types/pades.html" target="_blank" rel="noopener noreferrer">PADES</a> and XML documents in <a href="https://en.wikipedia.org/wiki/XAdES" target="_blank" rel="noopener noreferrer">XADES-BES</a> <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms767623%28v=vs.85%29" target="_blank" rel="noopener noreferrer">enveloped</a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mÃ©todos-de-envio">Sending methods<a href="#mÃ©todos-de-envio" class="hash-link" aria-label="Direct link to Sending methods" title="Direct link to Sending methods">â</a></h2>
<p>Once authentication has been successfully completed, we are ready to start sending documents.
The ilink API provides two approaches for sending documents:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sending-xml-in-ubl-21-cius-pt-format-or-ubl-21-peppolbis3---orders">Sending XML in UBL 2.1 CIUS-PT format (or UBL 2.1 PEPPOLBIS3 - Orders)<a href="#sending-xml-in-ubl-21-cius-pt-format-or-ubl-21-peppolbis3---orders" class="hash-link" aria-label="Direct link to Sending XML in UBL 2.1 CIUS-PT format (or UBL 2.1 PEPPOLBIS3 - Orders)" title="Direct link to Sending XML in UBL 2.1 CIUS-PT format (or UBL 2.1 PEPPOLBIS3 - Orders)">â</a></h3>
<p>In this method, the integrator system must correctly generate the XML file before sending it to ilink. eSPap provides the technical specification for the CIUS-PT format <a href="https://www.espap.gov.pt/Imagens/Documento.ashx?id=265" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>All XML files sent using this method <a href="https://ppr-svc.feap.gov.pt/Doc.Client/public/CIUSvalidation/PT?language=pt" target="_blank" rel="noopener noreferrer">are validated according to the official eSPap validator, version 2.1.2</a>, and the API will return an error if syntactic inconsistencies are found. eSPap provides a <a href="https://www.espap.gov.pt/Imagens/Documento.ashx?id=267" target="_blank" rel="noopener noreferrer">Schematron validator</a> that implements all the validations of <a href="https://ec.europa.eu/digital-building-blocks/sites/spaces/DIGITAL/pages/467108950/EN+16931+compliance" target="_blank" rel="noopener noreferrer">European Standard EN16931 CIUS</a> and the additional validations of CIUS-PT, available online <a href="https://ppr-svc.feap.gov.pt/Doc.Client/public/CIUSvalidation/PT?language=pt" target="_blank" rel="noopener noreferrer">at this link</a>. <strong>If the files validate syntactically in the <a href="https://ppr-svc.feap.gov.pt/Doc.Client/public/CIUSvalidation/PT?language=pt" target="_blank" rel="noopener noreferrer">online validator</a>, then they should validate in ilink, with the exception of any <a href="/en/docs/integrations/api/issued#additional-validations">additional validations</a> defined by the document recipient.</strong></p>
<blockquote>
<p><strong>Note:</strong> To add a <strong>PDF</strong> file to your electronic invoice and view other use cases, see the [use cases] section(usecases#criaÃ§Ã£o-de-documentos-por-envio-do-cius-pt).</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> eSPap also provides several <a href="https://www.espap.gov.pt/Imagens/Documento.ashx?id=254" target="_blank" rel="noopener noreferrer">CIUS-PT examples</a>.</p>
</blockquote>
<p>Some examples of errors in the XML validation process:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e217&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[BR-CO-25]-If the amount payable (BT-115) is positive, you must indicate the due date (BT-9) or the payment terms note(BT-20).&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e217&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[DT-CIUS-PT-166]-Amount due for payment (BT-115) = Invoice total amount with VAT (BT-112) -Paid amount (BT-113) +Rounding amount (BT-114), with an acceptance range of 1.00 â¬ (it does not mean that this tolerance is accepted by the customer).&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The method to be used for sending the XML is <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">POST /apps/documentsUBL</a></strong>. In this context, <strong>the public key identifies the issuer of the document</strong> and must correspond to the key associated with the issuer&#x27;s TIN specified in the XML (<code>AccountingSupplierParty&gt;Party&gt;PartyTaxScheme&gt;CompanyID</code> for invoices/credit notes, or <code>AccountingCustomerParty&gt;Party&gt;PartyTaxScheme&gt;CompanyID</code> for orders). If this does not occur, the API will return the following error:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;supplier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e199&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The entity creating the document must be a customer or supplier of the new document.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>If the XML is valid and complies with all the standard validations, as well as all <a href="/en/docs/integrations/api/issued#valida%C3%A7%C3%B5es-adicionais">additional business rules of the recipient</a>, the API returns a successful response, along with the main data from the created document:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">201</span><span class="token plain"> Created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s011&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document successfully created&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;60796c3c2a6fa2.53909016&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;7411111&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;emission_date&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-15&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type_document_fact&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5c9cb870a5ef57.36583702&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;380&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;invoice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;FT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Invoice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;issued&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Issued&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;state_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5c9cb878745b16.4225687&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sent&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sent to customer.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> A document is successfully sent to the recipient via EDI when the <code>state_document.alias</code> field has the value <code>sent</code> or <code>accepted</code>. If you only want the document to be sent by email, the document state should be ignored. Instead, you should consult the record of e-mails sent via <a href="/en/docs/integrations/api/issued#consulta-de-estado-de-documento-enviado-via-e-mail">state consultation</a>.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sending-structured-document-data">Sending structured document data<a href="#sending-structured-document-data" class="hash-link" aria-label="Direct link to Sending structured document data" title="Direct link to Sending structured document data">â</a></h3>
<p>When using this option, the ERP does not need to generate the entire XML file, as ilink is responsible for generating the final XML file. Thus, the ERP only needs to send all data related to the document to ilink. The endpoint to use here is <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocument" target="_blank" rel="noopener noreferrer">POST /apps/documents</a></strong></p>
<p><img decoding="async" loading="lazy" alt="img info" src="/en/assets/images/20210415-123923-45dc58da575be97ec00b5f16d9c8da41.png" width="1490" height="895" class="img_ev3q"></p>
<p>The specification for this method is extensive, as it covers all possible fields in an invoice/order, which are duly documented in the specification. All documents created by this endpoint are subject to the same validations as documents sent by the method <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">POST /apps/documentsUBL</a></strong>, in other words, the XML resulting from the data entered will be validated according to the official eSPap validator, which can be consulted online <a href="https://ppr-svc.feap.gov.pt/Doc.Client/public/CIUSvalidation/PT?language=pt" target="_blank" rel="noopener noreferrer">at this link</a>, and according to the <a href="/en/docs/integrations/api/issued#valida%C3%A7%C3%B5es-adicionais">additional business rules</a> of the document recipient, if any.</p>
<blockquote>
<p><strong>Note:</strong> To add a <strong>PDF</strong> file to an electronic invoice and other common situations, see the [use cases] section(usecases#criaÃ§Ã£o-de-documentos-por-envio-de-dados).</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> It is possible to send multiple attachments in a document using the <code>files[]</code> field (see specification above). However, the visual representation of the document (i.e. the original PDF of the invoice used for printing) must always be sent in the <code>file</code> field, with the <code>files[]</code> field reserved for additional files (order notes, dispatch notices, transport guides, etc.). **If the document issuer has an active digital signature on ilink, all attachments will be signed by default, and transaction consumption will take into account the total size of all attachments sent (1 transaction is debited for every 1MB of attachments sent).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="envio-do-documento">Sending the document<a href="#envio-do-documento" class="hash-link" aria-label="Direct link to Sending the document" title="Direct link to Sending the document">â</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sending-via-edi">Sending via EDI<a href="#sending-via-edi" class="hash-link" aria-label="Direct link to Sending via EDI" title="Direct link to Sending via EDI">â</a></h3>
<p>A document, after being successfully created by any of the methods described (<a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">XML sending</a> or <a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocument" target="_blank" rel="noopener noreferrer">data sending</a>), will be automatically sent to the recipient by EDI. However, in specific cases, it may not be sent immediately via EDI due to missing configurations and/or other anomalies in the ilink platform or the recipient&#x27;s system. If this occurs, a <code>to_send_status</code> field will be returned in the document response to detail the situation:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">201</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s011&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document successfully created&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;60796c3c2a6fa2.53909016&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;state_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5c9cb870f34b16.42025494&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tosend&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;To be sent to the customer.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;to_send_status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sent_connection&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Await acceptance of connection with the recipient of the document.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> You can verify that the document was <strong>NOT</strong> delivered via EDI because the <code>state_document.alias</code> field assumes the value <code>tosend</code> and the reason for the error is described in the <code>to_send_state</code> field. In this situation, you must first complete the EDI connection with the recipient and then resend the document.</p>
</blockquote>
<p>The possible reasons (<code>code</code>) for a document not being sent are:</p>
<ul>
<li><code>sent_connection</code>, <code>no_connection</code>: Missing connection with recipient</li>
<li><code>registered_entity</code>: The recipient is not registered with ilink</li>
<li><code>received_pay_transactions</code>: The recipient bears the costs of the documents received but does not have sufficient transactions to send the document</li>
</ul>
<p>After rectifying the error, you will be able to resend the document (see section on [resending documents])(issued#criareditar-documento)).</p>
<blockquote>
<p><strong>Note</strong>: The document state (<code>state_document</code>) only applies to EDI sendings. If the document is only sent to an arbitrary customer via e-mail (PDF), the sending state does not reflect the sending of the e-mail. See the following <a href="/en/docs/integrations/api/issued#consulta-de-estado-de-documento-enviado-via-e-mail">section</a> for more information.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sending-via-email">Sending via email<a href="#sending-via-email" class="hash-link" aria-label="Direct link to Sending via email" title="Direct link to Sending via email">â</a></h3>
<p>After a document has been successfully created (HTTP status 201) using any of the methods described (<a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">sending XML</a> or <a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocument" target="_blank" rel="noopener noreferrer">sending data</a>), it will be sent via email to the recipient if the <code>send_by_email</code> field is specified with the value <code>1</code>. The address(es) of the recipient(s) of the document can be specified in three ways:</p>
<ul>
<li>in the <code>additional_emails[]</code> field (in both sending methods)</li>
<li>in the <code>customer[email]</code> field (only in the sending data method)</li>
<li>in the <code>cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:ElectronicMail</code> XML element (only in the sending XML method).</li>
</ul>
<p>To check the sending of emails and their reading by the customer, see the section on <a href="/en/docs/integrations/api/issued#consulta-de-estado-de-documentos-emitidos">checking the state of issued documents</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="criaÃ§Ã£o-de-documentos-e-consumo-de-assinaturas-digitais-qualificadas">Creation of documents and use of qualified digital signatures<a href="#criaÃ§Ã£o-de-documentos-e-consumo-de-assinaturas-digitais-qualificadas" class="hash-link" aria-label="Direct link to Creation of documents and use of qualified digital signatures" title="Direct link to Creation of documents and use of qualified digital signatures">â</a></h3>
<blockquote>
<p><strong>Note</strong>: This section is only relevant for customers who use ilink to digitally sign issued documents. <a href="/en/docs/integrations/api/issued#assinatura-digital">See details</a>.</p>
</blockquote>
<p>If a qualified digital signature is configured in ilink, all documents will be signed at the time of creation, including all files resulting from the electronic invoice (xml and pdf). Given that document signature is not required by law in all usage scenarios, it is possible to individually control the signature of xml and pdf files at the time of document creation using the <code>disable_xml_sign</code> and <code>disable_pdf_sign</code> fields, available in both document creation methods ( <a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">XML</a> or <a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocument" target="_blank" rel="noopener noreferrer">data</a>). This reduces the consumption of digital signatures and optimises the document creation process.</p>
<p>In other words:</p>
<ul>
<li>When sending a digital invoice via <strong>signed PDF to an end consumer or private customer</strong>, it will not be mandatory to sign the resulting XML file, so we recommend using the field <code>disable_xml_sign: 1</code>.</li>
<li>When sending electronic invoices to the <strong>Public Administration via EDI</strong> (e.g. eSPap), it is not mandatory to sign the document; however, it is always possible to sign both files for additional security and integrity reasons. If, for example, you wish to disable the digital signature on the PDF attachment, simply use the option <code>disable_pdf_sign: 1</code>.</li>
<li><strong>The fields described above only take effect when the document issuer uses a qualified digital signature in ilink.</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="validaÃ§Ãµes-adicionais">Additional validations<a href="#validaÃ§Ãµes-adicionais" class="hash-link" aria-label="Direct link to Additional validations" title="Direct link to Additional validations">â</a></h2>
<p>The invoice recipient can configure additional requirements for certain fields (business rules) in ilink, even when these are not mandatory in the CIUS-PT specification. For example, a customer may specify that he or she only accepts invoices with a PDF file attached or with a specific commitment number. It is essential that these requirements are agreed in advance with the customer/recipient before going into production, in order to avoid integration errors.</p>
<p>If the document recipient requires the presence of a field not specified in the XML, the API will return an error as shown below and the document will not be generated:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;commitment_number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e048&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The commitment number is mandatory.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Please note that errors are only returned in this format when the document recipient is an ilink customer and has the appropriate business rules configured on the platform. When a document is sent to an external EDI system, any failure in the validation process is normally communicated at a later time via a state change to <strong>Rejected</strong>, with the appropriate error message. It is important to note that not all EDI systems support the sending of state messages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="criareditar-documento">Create/edit document<a href="#criareditar-documento" class="hash-link" aria-label="Direct link to Create/edit document" title="Direct link to Create/edit document">â</a></h2>
<p>A document can be edited and resent to the recipient:</p>
<ul>
<li>if <strong>it has not yet been sent</strong> to the end customer</li>
<li>or if <strong>it has already been sent to the customer and the customer has requested a correction</strong></li>
</ul>
<p>In practical terms, the possibility of resending can be checked using the following response field in the document:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;state_edi_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> &lt;state&gt; </span><span class="token comment" style="color:#999988;font-style:italic">// possible resend states: &#x27;regularization&#x27; ou &#x27;reception&#x27; ou &#x27;error&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>To check the state of a document, see the section on <a href="/en/docs/integrations/api/issued#consulta-de-estado-de-documentos-emitidos">checking the state of issued documents</a>.</p>
<p>To edit an existing document, simply repeat the request <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocumentUBL" target="_blank" rel="noopener noreferrer">POST /apps/documentsUBL</a></strong> or <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/postDocument" target="_blank" rel="noopener noreferrer">POST /apps/documents</a></strong> with the corrected data, keeping the <strong>number, type and date of issue</strong> of the previous document:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">HTTP</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">OK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s012&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document successfully created&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;60796c3c2a6fa2.53909016&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;7411111&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;emission_date&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-16&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type_document_fact&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5c9cb870a5ef57.36583702&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;380&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;invoice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;FT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Invoice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;issued&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Issued&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;state_document&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5c9cb870f34b16.42025494&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;alias&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tosend&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;To be sent to the customer.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>If the document is not eligible for editing (i.e. it has already been sent or accepted by the end customer), an error will be displayed when attempting to resend it:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> Bad request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e200&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document already exists.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="access-to-issued-documents">Access to issued documents<a href="#access-to-issued-documents" class="hash-link" aria-label="Direct link to Access to issued documents" title="Direct link to Access to issued documents">â</a></h2>
<p>When a document is successfully registered, an <code>id</code> will always be returned in the responses, which identifies it to ilink. It is useful to save this identifier for future queries to the document.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">201</span><span class="token plain"> Created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s011&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Document successfully created&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;60796c3c2a6fa2.53909016&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The API also allows you to access all data (including generated XML and PDF) from all previously issued documents. To do so, use the <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocument" target="_blank" rel="noopener noreferrer">GET /apps/documents/{id}</a></strong> method. The <code>id</code> received when creating the document must be used as a parameter here to access the corresponding document.</p>
<p>All data returned by this method is available in the specification.</p>
<blockquote>
<p><strong>Note</strong>: If the entity issuing the document has configured automatic document signature in ilink, the URLs for accessing the XML and PDF files will already return the signed files.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="consultation-of-documents-issued-on-the-portal-optional">Consultation of documents issued on the portal (optional)<a href="#consultation-of-documents-issued-on-the-portal-optional" class="hash-link" aria-label="Direct link to Consultation of documents issued on the portal (optional)" title="Direct link to Consultation of documents issued on the portal (optional)">â</a></h2>
<p>The documents can also be consulted on the <a href="https://ilink.acin.pt" target="_blank" rel="noopener noreferrer">ilink test portal</a> using the credentials provided by the entities. Here you can visually validate whether the information presented is consistent with the data sent via API:</p>
<p><img decoding="async" loading="lazy" alt="img info" src="/en/assets/images/20230420-133607-c5d03a751653d102acc0ed60c783eee4.png" width="1596" height="839" class="img_ev3q"></p>
<p>To access the attachments of a document, you must access the document in the table and click on the magnifying glass icon:</p>
<p><img decoding="async" loading="lazy" alt="img info" src="/en/assets/images/20230420-133914-c96ee4049998eb70825f7dcb46b5c6fb.png" width="1605" height="838" class="img_ev3q"></p>
<blockquote>
<p><strong>Note:</strong> The documents must be present both at the issuing entity (issued documents section) and at the receiving entity (received documents section).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="consulta-de-estado-de-documentos-emitidos">Consultation of state of issued documents<a href="#consulta-de-estado-de-documentos-emitidos" class="hash-link" aria-label="Direct link to Consultation of state of issued documents" title="Direct link to Consultation of state of issued documents">â</a></h2>
<p>It is also possible to access the current state of previously issued documents. This operation allows the issuer of the document to check whether the document has been accepted by the customer, or whether it is pending resending/regularisation, as well as the reasons that led to this.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consultation-of-the-state-of-documents-sent-via-edi">Consultation of the state of documents sent via EDI<a href="#consultation-of-the-state-of-documents-sent-via-edi" class="hash-link" aria-label="Direct link to Consultation of the state of documents sent via EDI" title="Direct link to Consultation of the state of documents sent via EDI">â</a></h3>
<p>Ilink provides four simplified document states in the <code>state_document</code> property:</p>
<table><thead><tr><th>State</th><th>alias</th><th>Description</th></tr></thead><tbody><tr><td><strong>To be sent</strong></td><td><code>tosend</code></td><td>the document has not been sent to the customer. This probably means that some configuration is missing in ilink, the sender/recipient does not authorise a connection between them, or that some of the entities in the document do not have sufficient transactions to proceed with the sending. If you only want the document to be sent via email, this state should be ignored.</td></tr><tr><td><strong>Sent</strong></td><td><code>sent</code></td><td>The document has been sent to the customer and is awaiting acceptance. Please note that not all recipient systems support state communication, so some documents may never leave this state.</td></tr><tr><td><strong>Accepted</strong></td><td><code>accepted</code></td><td>The document has been sent and the customer has approved it. <strong>Final state</strong>.</td></tr><tr><td><strong>Rejected</strong></td><td><code>rejected</code></td><td>The document was sent and the customer rejected it due to an inconsistency. The reason for rejection is provided in the response in the <code>reasons</code> field. <a href="/en/docs/integrations/api/issued#criareditar-documento">The document can be sent again</a> if a regularisation is requested.</td></tr></tbody></table>
<blockquote>
<p><strong>Note:</strong> Ilink also returns the <strong>EDI processing state</strong> of the document (<code>state_edi_document</code>), which is independent of the above states. For more information, see the <a href="https://www.espap.gov.pt/Imagens/Documento.ashx?id=269" target="_blank" rel="noopener noreferrer">FE-AP Document Transmission Guide, page 7</a>. However, reading the EDI state is not always relevant for invoicing software.</p>
</blockquote>
<p>There are 3 approaches to accessing the state of a previously issued document: <strong>Individual state consultation</strong>, <strong>State change webhook</strong>, and <strong>State report</strong>.</p>
<ul>
<li>
<p>In <strong>Individual state consultation</strong>, simply make the call <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocument" target="_blank" rel="noopener noreferrer">GET /apps/documents/{id}</a></strong>. The <code>id</code> received when creating the document must be used as a parameter to access the document in question. The state is returned in the <code>state_document</code> field (see specification). This method only allows you to check the state of one document at a time, and as such is not recommended for customers who process a high volume of documents.</p>
</li>
<li>
<p>In the <strong>State change webhook</strong>, ilink takes the initiative to inform the document issuer whenever the document changes state. This is the recommended option in terms of performance and speed, but it may not be feasible if the system to be integrated belongs to a network that is not publicly exposed to ilink. For more information, see the <a href="/en/docs/integrations/webhooks/intro">Webhooks</a> section.</p>
</li>
<li>
<p>In <strong>State report</strong>, the integrator application takes the initiative to consult the various events that led to changes in the state of the documents issued. To do so, simply make the call <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Hist%C3%B3rico%20de%20estados/getStatesReport" target="_blank" rel="noopener noreferrer">GET /apps/states-report/documents</a></strong>. Each event identifies the document and the changed state. It is possible to filter the returned events by document <code>id</code>, document number, date ranges, among others (see specification). This method allows the application to check the state of several documents simultaneously.</p>
<p>In order to facilitate the use of state reporting, an event read endpoint is also available <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Hist%C3%B3rico%20de%20estados/postStatesReportRead" target="_blank" rel="noopener noreferrer">POST /apps/states-report/documents/read</a></strong>, which allows one or more previously obtained event <code>id</code>s to be marked as read. Events marked as read are not returned again in the state reporting endpoint, facilitating future queries of the previous method. This option is a scalable alternative for systems that cannot implement Webhooks.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consulta-de-estado-de-documento-enviado-via-e-mail">Consultation of the state of documents sent via e-mail<a href="#consulta-de-estado-de-documento-enviado-via-e-mail" class="hash-link" aria-label="Direct link to Consultation of the state of documents sent via e-mail" title="Direct link to Consultation of the state of documents sent via e-mail">â</a></h3>
<p>When sending documents by email, it is possible to consult the record of e-mails sent to the customer and their read state. <strong>Please note that the state of the returned document (<code>state_document</code>) is not applicable in this scenario</strong>, as these documents are not normally sent via EDI, and as such, their sending state will usually be <code>to_send</code>. This state should be ignored in favour of the approaches described below:</p>
<ul>
<li>In <strong>Individual state consultation</strong>, simply make the call <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocument" target="_blank" rel="noopener noreferrer">GET /apps/documents/{id}</a></strong>. The <code>id</code> received when creating the document must be used as a parameter to access the document in question. In the response, you must access the <code>emails</code> property, which returns a list of sent messages and their reception and reading state. This method only allows you to query the state of one document at a time and has the same limitations as the individual document query in the previous section:</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;data&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;60796c3c2a6fa2.53909016&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;emails&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;634672bab0f3b8.40302642&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;b_open&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// true if the e-mail has been read by the recipient</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;b_sent&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// true if the e-mail was successfully sent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;created_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2022-10-12 08:54:34&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// date and time of e-mail sending</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;opened_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2022-10-12 09:14:16&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// date and time of email reading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;address&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;emails&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;joao.freitas@email.com&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// sending address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> Some email clients (Outlook, etc.) may block the reading of emails, leaving <code>b_open</code> as false even if the email has been opened in some situations. Ilink also has the ability to detect if an email has been returned by the e-mail server, taking responsibility for successive attempts to resend it over time.</p>
</blockquote>
<ul>
<li>In <strong>Document history consultation</strong>, you can consult all procedural changes to a given document. This history will list all state changes that have occurred in the document in chronological order, as well as records of e-mails sent to the recipient, allowing for complete audit tracking. It can be accessed via <strong><a href="https://ilink.acin.pt/swagger-ui/dist/index.html#/Documentos/getDocumentHistory" target="_blank" rel="noopener noreferrer">GET /apps/documents/{id}/history</a></strong>.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/integrations/api/specification"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Technical Specification</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/integrations/api/received"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Receiving documents</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scope" class="table-of-contents__link toc-highlight">Scope</a></li><li><a href="#assinatura-digital" class="table-of-contents__link toc-highlight">Digital signature</a></li><li><a href="#mÃ©todos-de-envio" class="table-of-contents__link toc-highlight">Sending methods</a><ul><li><a href="#sending-xml-in-ubl-21-cius-pt-format-or-ubl-21-peppolbis3---orders" class="table-of-contents__link toc-highlight">Sending XML in UBL 2.1 CIUS-PT format (or UBL 2.1 PEPPOLBIS3 - Orders)</a></li><li><a href="#sending-structured-document-data" class="table-of-contents__link toc-highlight">Sending structured document data</a></li></ul></li><li><a href="#envio-do-documento" class="table-of-contents__link toc-highlight">Sending the document</a><ul><li><a href="#sending-via-edi" class="table-of-contents__link toc-highlight">Sending via EDI</a></li><li><a href="#sending-via-email" class="table-of-contents__link toc-highlight">Sending via email</a></li><li><a href="#criaÃ§Ã£o-de-documentos-e-consumo-de-assinaturas-digitais-qualificadas" class="table-of-contents__link toc-highlight">Creation of documents and use of qualified digital signatures</a></li></ul></li><li><a href="#validaÃ§Ãµes-adicionais" class="table-of-contents__link toc-highlight">Additional validations</a></li><li><a href="#criareditar-documento" class="table-of-contents__link toc-highlight">Create/edit document</a></li><li><a href="#access-to-issued-documents" class="table-of-contents__link toc-highlight">Access to issued documents</a></li><li><a href="#consultation-of-documents-issued-on-the-portal-optional" class="table-of-contents__link toc-highlight">Consultation of documents issued on the portal (optional)</a></li><li><a href="#consulta-de-estado-de-documentos-emitidos" class="table-of-contents__link toc-highlight">Consultation of state of issued documents</a><ul><li><a href="#consultation-of-the-state-of-documents-sent-via-edi" class="table-of-contents__link toc-highlight">Consultation of the state of documents sent via EDI</a></li><li><a href="#consulta-de-estado-de-documento-enviado-via-e-mail" class="table-of-contents__link toc-highlight">Consultation of the state of documents sent via e-mail</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 ilink.pt | apoio@ilink.pt | 707 451 451</div></div></div></footer></div>
</body>
</html>