{"searchDocs":[{"title":"Integra√ß√£o acinGov","type":0,"sectionRef":"#","url":"/en/docs/acingov","content":"Integra√ß√£o acinGov O presente manual demonstra o processo a seguir para configurar a integra√ß√£o entre a plataforma de compras p√∫blicas acinGov e o software de fatura√ß√£o eletr√≥nica ilink. Ap√≥s login no ilink, aceda ao menu Entidade &gt; Dados da Entidade e copie a chave p√∫blica que vai possibilitar a integra√ß√£o com a plataforma acinGov. Depois, efetue o seu login na plataforma acinGov, clique em Configura√ß√µes &gt; Informa√ß√£o Base e introduza a chave que copiou anteriormente. No final clique em ‚ÄòAssociar conta‚Äô. Para remover a conta basta clicar na op√ß√£o abaixo. Ap√≥s estes passos, o √≠cone do ilink ser√° apresentado no canto superior direito do seu menu. Desta forma saber√° que a integra√ß√£o foi conclu√≠da com sucesso. Nota: Ao clicar sobre o logotipo ser√° automaticamente redirecionado para o ilink, sem necessidade de introduzir os dados de acesso.","keywords":"","version":"Next"},{"title":"Integra√ß√£o Moloni","type":0,"sectionRef":"#","url":"/en/docs/moloni","content":"","keywords":"","version":"Next"},{"title":"Configura√ß√£o do Moloni‚Äã","type":1,"pageTitle":"Integra√ß√£o Moloni","url":"/en/docs/moloni#configura√ß√£o-do-moloni","content":" Ap√≥s efetuar login no Moloni, devemos aceder a Configura√ß√µes &gt; Developers &gt; Config API  Aqui √© necess√°rio:  Ativar o APIIntroduzir o URL de callback de resposta (https://ilink.acin.pt)    Dever√£o tamb√©m tomar nota dos seguintes valores que s√£o gerados automaticamente:  developer IDclient secret  ","version":"Next","tagName":"h2"},{"title":"Configura√ß√£o do ilink‚Äã","type":1,"pageTitle":"Integra√ß√£o Moloni","url":"/en/docs/moloni#configura√ß√£o-do-ilink","content":" Ap√≥s guardar as altera√ß√µes do lado do Moloni, entrar no ilink e ir a Integra√ß√µes &gt; Recep√ß√£o:  O developer ID adquirido no Moloni √© inserido no identificador do cliente no ilinkO client secret adquirido no Moloni √© introduzido em chave do cliente no ilinkO utilizador e palavra passe s√£o os dados de acesso da entidade Moloni.  Nota: Ambas as entidades (no Moloni e ilink) t√™m de possuir o mesmo NIF para a integra√ß√£o ser criada correctamente.  Ap√≥s ativar esta configura√ß√£o, o ilink ir√° sincronizar automaticamente todos os documentos emitidos no Moloni, e estes aparecem em Integra√ß√µes &gt; Moloni:    Devemos selecionar os documentos a importar, que ir√£o ficar em Emitidos &gt; Por enviar   ","version":"Next","tagName":"h2"},{"title":"Integra√ß√£o Medidata","type":0,"sectionRef":"#","url":"/en/docs/medidata","content":"","keywords":"","version":"Next"},{"title":"Funcionamento‚Äã","type":1,"pageTitle":"Integra√ß√£o Medidata","url":"/en/docs/medidata#funcionamento","content":" O ilink tem a capacidade de integrar faturas com os programas da suite Medidata, tanto no inbound (rece√ß√£o de documentos na aplica√ß√£o Sigma) como no outbound (envio de documentos da aplica√ß√£o das √°guas).  Para tal processo funcionar, √© necess√°rio assegurar os seguintes requisitos do lado do cliente:  ","version":"Next","tagName":"h2"},{"title":"Inbound (envio de documentos do ilink para o software Medidata)‚Äã","type":1,"pageTitle":"Integra√ß√£o Medidata","url":"/en/docs/medidata#inbound-envio-de-documentos-do-ilink-para-o-software-medidata","content":" √â necess√°rio que o cliente disponibilize um servidor SFTP, com permiss√µes de escrita, e acess√≠vel publicamente ou aos IPs do ilink com regras NAT:  62.28.56.161, 62.28.56.162 (ilink testes)193.43.40.153 (ilink produ√ß√£o)Opcionalmente, podem ser autorizadas as gamas de IP anteriores.  Nota: Apenas √© suportado o protocolo SFTP. Liga√ß√µes FTP, mesmo com encripta√ß√£o TLS/SSL, n√£o s√£o aceites.  Este servidor dever√° ser tamb√©m acess√≠vel ao software Medidata (normalmente atrav√©s do mapeamento de uma pasta de rede). O objetivo √© que seja poss√≠vel ao ilink criar ficheiros neste servidor e que os mesmos consigam ser lidos pelo software Medidata atrav√©s da pasta INBOUND.  Ap√≥s a cria√ß√£o do mesmo, devem-nos enviar os seguintes dados para serem configurados no ilink:  endere√ßo/IP do servidorportautilizadorpalavra-passe  ","version":"Next","tagName":"h2"},{"title":"Outbound (envio de documentos do software Medidata para o ilink)‚Äã","type":1,"pageTitle":"Integra√ß√£o Medidata","url":"/en/docs/medidata#outbound-envio-de-documentos-do-software-medidata-para-o-ilink","content":" √â necess√°rio configurar o m√≥dulo da aplica√ß√£o das √°guas para gerar os ficheiros XML num servidor SFTP, que dever√£o enviar os acessos ao ilink. Este servidor SFTP pode igualmente ser configurado como uma pasta de rede, de modo a que a aplica√ß√£o das √°guas guarde os ficheiros XML nessa pasta, e estes fiquem imediatamente dispon√≠veis no servidor SFTP. N√£o √© necess√°rio disponibilizar os ficheiros PDF na pasta de outbound.  Necessita igualmente de permiss√µes de leitura e escrita p√∫blicas ou para os nossos IPs com regras NAT:  62.28.56.161 (ilink testes)193.43.40.153 (ilink produ√ß√£o)Opcionalmente, podem ser autorizadas as gamas de IP anteriores.  Nota: Apenas √© suportado o protocolo SFTP. Liga√ß√µes FTP, mesmo com encripta√ß√£o TLS/SSL, n√£o s√£o aceites.  Ap√≥s a cria√ß√£o do mesmo, devem-nos enviar os seguintes dados para serem configurados no ilink:  endere√ßo/IP do servidorportautilizadorpalavra-passe  ","version":"Next","tagName":"h2"},{"title":"Estrutura de pastas Medidata‚Äã","type":1,"pageTitle":"Integra√ß√£o Medidata","url":"/en/docs/medidata#estrutura-de-pastas-medidata","content":" Por norma, os servidores Medidata devem ter a seguinte estrutura de pastas preparadas para a emiss√£o e rece√ß√£o de documentos:  / ‚îú‚îÄ‚îÄ IN # O ilink coloca aqui as faturas a receber pelo Medidata ‚îú‚îÄ‚îÄ OUT # Medidata coloca os estados dos documentos recebidos e processados aqui ‚îú‚îÄ‚îÄ OUTBOUND ‚îÇ ‚îú‚îÄ‚îÄ ADERENTES ‚îÇ ‚îú‚îÄ‚îÄ COPIAS ‚îÇ ‚îú‚îÄ‚îÄ DOCUMENTOS # Medidata coloca aqui os ficheiros a enviar para o ilink | | | (IMPORTANTE: N√ÉO separar em subpastas por NIF) ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ERRORS # O ilink coloca os ficheiros com erro aqui: consultar registo de integra√ß√£o ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ FAILED # O ilink coloca aqui os ficheiros que n√£o conseguiu processar ‚îÇ ‚îî‚îÄ‚îÄ RESPOSTAS ‚îÇ ‚îî‚îÄ‚îÄ DOCUMENTOS ‚îÇ ‚îî‚îÄ‚îÄ FicheiroEstados.txt # O ilink comunica aqui as refer√™ncias das faturas criadas e enviadas ‚îú‚îÄ‚îÄ READED ‚îî‚îÄ‚îÄ RESPOSTAS   ","version":"Next","tagName":"h2"},{"title":"Consulta de documentos e registos de integra√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o Medidata","url":"/en/docs/medidata#consulta-de-documentos-e-registos-de-integra√ß√£o","content":" √â poss√≠vel consultar os documentos emitidos e recebidos no ilink acedendo ao portal, nas √°reas deDocumentos Emitidos e Documentos Recebidos.  Para consulta dos documentos comunicados via integra√ß√£o com o Medidata (an√°lise de erros, confirma√ß√£o de rece√ß√£o, etc), √© poss√≠vel aceder √† √°rea Integra√ß√µes &gt; Registos de Integra√ß√£o, e verificar quaisquer erros que ocorreram na comunica√ß√£o de documentos.  Nota: √â poss√≠vel configurar o envio de um relat√≥rio via email ap√≥s o envio de documentos emitidos pelo Medidata. Deste modo, √© poss√≠vel confirmar que documentos foram enviados com sucesso, bem como poss√≠veis erros de integra√ß√£o e envio. ","version":"Next","tagName":"h2"},{"title":"Lista de Integra√ß√µes","type":0,"sectionRef":"#","url":"/en/docs/integracoes-ilink","content":"","keywords":"","version":"Next"},{"title":"ERPs/Sistemas de fatura√ß√£o‚Äã","type":1,"pageTitle":"Lista de Integra√ß√µes","url":"/en/docs/integracoes-ilink#erpssistemas-de-fatura√ß√£o","content":" iGESTb-OnlineMoloniXISConnectPrimavera (requer conector ILINK)SAGE X3 F5IT PHC WinSigAnt√∫rioNovos canaisNorma6BetaSystemsPHCResolveNSOFTMicrolopesSeguinf SAP Lead4B Microsoft Dynamics NAV ArquiconsultSquadMicrosoft Business Central (cpcIT4all) WorkInNetAltmaia Fatura√ß√£oMicroDigitalSIAGFacturamaXDArtsoftKeyInvoiceTripointEdiprinterSigPorForenseSendysR2 Inform√°ticaDigiSoftProt√≥tipoQuidgestOriGestRentway ChallengeIT Prot√≥tipoAquamatrixFcore FapricelaNewHotelGRIDGolfinhosoftPlataforma WattElsifWebgescomINOVAsis  ","version":"Next","tagName":"h2"},{"title":"Gest√£o de Autarquias‚Äã","type":1,"pageTitle":"Lista de Integra√ß√µes","url":"/en/docs/integracoes-ilink#gest√£o-de-autarquias","content":" iFREG-SNC-APiTaxasMedidata Sigma-SNCairc SNC-APFresoft ERP  ","version":"Next","tagName":"h3"},{"title":"Gest√£o Documental‚Äã","type":1,"pageTitle":"Lista de Integra√ß√µes","url":"/en/docs/integracoes-ilink#gest√£o-documental","content":" iDokeDocuments - FlowinnWebdoc Ambisig  ","version":"Next","tagName":"h3"},{"title":"Contrata√ß√£o P√∫blica‚Äã","type":1,"pageTitle":"Lista de Integra√ß√µes","url":"/en/docs/integracoes-ilink#contrata√ß√£o-p√∫blica","content":" acinGov  ","version":"Next","tagName":"h3"},{"title":"Brokers EDI‚Äã","type":1,"pageTitle":"Lista de Integra√ß√µes","url":"/en/docs/integracoes-ilink#brokers-edi","content":" SaphetyCegid YetEdicomSERESGenerixIndra - MinsaitFE-APPageroeFaturaGovSeeburgerInposiaCompacerMontovabaVel - Voxel GroupAtos - Eviden  *Lista atualizada a 2025-04-24 ","version":"Next","tagName":"h3"},{"title":"Integra√ß√£o iGEST","type":0,"sectionRef":"#","url":"/en/docs/igest","content":"","keywords":"","version":"Next"},{"title":"Configura√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o iGEST","url":"/en/docs/igest#configura√ß√£o","content":" Ap√≥s efetuada a ades√£o √† plataforma iLink, aceda ao menu Entidade &gt; Dados da Entidade e copie a chave p√∫blica que vai possibilitar a integra√ß√£o com o software fatura√ß√£o iGEST.    Para permitir a rece√ß√£o de documentos de fatura√ß√£o do iGEST para o iLink dever√° ativar a integra√ß√£o. Para tal, aceda ao meu Integra√ß√µes &gt; Rece√ß√£o e clique em ‚ÄòAtivar‚Äô.    Por sua vez, para permitir o envio de documentos de fatura√ß√£o do iLink para o iGEST dever√° ativar a integra√ß√£o. Aceda ao meu Integra√ß√µes &gt; Integra√ß√µes - Envio e clique em ‚ÄòAtivar‚Äô.    Ap√≥s estas configura√ß√µes iniciais na plataforma iLink, vamos proceder √† configura√ß√£o do software de fatura√ß√£o iGEST.  Efetue o seu login no iGEST para ativar a integra√ß√£o com a plataforma iLINK. Para tal, deve dirigir-se ao menu Entidade &gt; Configurar &gt; Integra√ß√µes e escolher ILINK. Aqui deve inserir os dados de acesso e chave p√∫blica:    Nota: O cliente pode configurar alguns campos como sendo obrigat√≥rios para os documentos recebidos no ilink. O N√∫mero de encomenda √© um desses campos: Para enviar esse campo, ao emitir o documento no iGEST, deve adicionar uma informa√ß√£o adicional com um dos seguintes nomes:  N¬∫ EncomendaN√∫mero EncomendaN√∫mero de EncomendaEncomenda.    Nota 2: Um documento ficar√° dispon√≠vel para reenvio caso seja rejeitado pelo cliente no iLink por motivo ‚ÄúRegularizar‚Äù  ","version":"Next","tagName":"h2"},{"title":"Como enviar documentos para o iLINK manualmente?‚Äã","type":1,"pageTitle":"Integra√ß√£o iGEST","url":"/en/docs/igest#como-enviar-documentos-para-o-ilink-manualmente","content":" Menu Entidade &gt; iLINK - Digital Sharing &gt; Documentos por enviarSeleccionar documentos pretendidosClicar em enviar selecionados  ","version":"Next","tagName":"h2"},{"title":"Como importar documentos compras dos fornecedores?‚Äã","type":1,"pageTitle":"Integra√ß√£o iGEST","url":"/en/docs/igest#como-importar-documentos-compras-dos-fornecedores","content":" Menu Entidade &gt; iLINK - Digital Sharing &gt; Documentos por importarSeleccionar documentos pretendidosClicar em importar selecionadosPara consultar documentos importados devem ir a menu Compras &gt; Pesquisar  ","version":"Next","tagName":"h2"},{"title":"Como consultar estado/hist√≥rico documentos enviados?‚Äã","type":1,"pageTitle":"Integra√ß√£o iGEST","url":"/en/docs/igest#como-consultar-estadohist√≥rico-documentos-enviados","content":" Menu Entidade &gt; iLINK - Digital Sharing &gt; Hist√≥rico de envio  ","version":"Next","tagName":"h2"},{"title":"Como consultar hist√≥rico documentos importados?‚Äã","type":1,"pageTitle":"Integra√ß√£o iGEST","url":"/en/docs/igest#como-consultar-hist√≥rico-documentos-importados","content":" Menu Entidade &gt; iLINK - Digital Sharing &gt; Hist√≥rico de importa√ß√£o ","version":"Next","tagName":"h2"},{"title":"Webhooks ilink","type":0,"sectionRef":"#","url":"/en/docs/webhooks-ilink","content":"","keywords":"","version":"Next"},{"title":"√Çmbito‚Äã","type":1,"pageTitle":"Webhooks ilink","url":"/en/docs/webhooks-ilink#√¢mbito","content":" Neste modelo de comunica√ß√£o, o ilink toma a iniciativa de comunicar ao ERP no momento que um determinado evento ocorre, dispensando de consultas frequentes ao nosso API.  O ilink disponibiliza 2 webhooks:  Webhook de novo documento - enviado ao receptor cada vez que um novo documento lhe √© encaminhadoWebhook de mudan√ßa de estado de documento - enviado ao emissor cada vez que um documento previamente emitido altera o seu estado  Para qualquer dos webhooks acima funcionar √© necess√°rio:  Implementar um endpoint Web, dispon√≠vel publicamente aos servidores do ilink, ao qual o ilink ir√° comunicar via HTTP. Os dados enviados do ilink para este URL p√∫blico est√£o de acordo com o webhook que pretendem implementar (ver abaixo)Comunicar √† equipa do ilink que pretendem implementar o Webhook espec√≠fico para o vosso cliente, e indicar-nos uma chave de acesso e o URL p√∫blico do vosso endpoint.  Este m√©todo, apesar de implementa√ß√£o mais extensa, tem a vantagem de evitar polling constante aos nossos servidores, consumir menos recursos em ambos os sistemas, e permite aceder a toda a informa√ß√£o em tempo real. S√≥ recomendamos optar pela consulta manual caso existam implica√ß√µes de seguran√ßa na abordagem dos Webhooks (ver abaixo).  ","version":"Next","tagName":"h2"},{"title":"Informa√ß√£o importante / Implica√ß√µes de Seguran√ßa‚Äã","type":1,"pageTitle":"Webhooks ilink","url":"/en/docs/webhooks-ilink#informa√ß√£o-importante--implica√ß√µes-de-seguran√ßa","content":" Esta op√ß√£o assume que o URL/porta em quest√£o est√° dispon√≠vel publicamente, ou pelo menos acess√≠vel aos nossos ambientes de testes e produ√ß√£o! Para tal, poder√° ser necess√°rio abrir portas ou criar as seguintes excep√ß√µes no firewall da m√°quina que executa o servi√ßo web:  https://ilink.acin.pt (62.28.56.162:443) - testeshttps://ilink.pt (194.38.136.153:443 193.43.40.153:443) - produ√ß√£o  Caso falhe o processo de comunica√ß√£o de um documento, o ilink ir√° tentar comunicar novamente at√© 10 vezes nos pr√≥ximos 7 dias, com intervalos incrementalmente maiores por cada tentativa. Ap√≥s 10 tentativas falhadas de comunica√ß√£o, o ilink ir√° deixar de tentar comunicar esse documento ao ERP.  Um documento √© considerado entregue com sucesso ao ERP quando a reposta do webhook retorna um HTTP status code 200 (independentemente do conte√∫do da resposta).  Importante: Na implementa√ß√£o deste endpoint, o ERP tem a responsabilidade de validar a chave de acesso e posteriormente registar a informa√ß√£o recebida no seu sistema. Recomendamos vivamente ao vosso sistema validar a chave de acesso enviada nos headers da nossa resposta, caso contr√°rio est√£o a aceitar dados provenientes de origem desconhecida. O ilink envia a vossa chave no header Authorization: Bearer {CHAVE_INTEGRACAO}.  ","version":"Next","tagName":"h2"},{"title":"Webhooks‚Äã","type":1,"pageTitle":"Webhooks ilink","url":"/en/docs/webhooks-ilink#webhooks","content":" ","version":"Next","tagName":"h2"},{"title":"Webhook de novo documento‚Äã","type":1,"pageTitle":"Webhooks ilink","url":"/en/docs/webhooks-ilink#webhook-de-novo-documento","content":" O webhook de novo documento √© uma alternativa √† consulta frequente de documentos por parte da entidade receptora. Cada vez que chega um novo documento a esta entidade, o callback de novo documento ser√° invocado.  O endpoint implementado dever√° esperar os seguintes dados desta especifica√ß√£o.  ","version":"Next","tagName":"h3"},{"title":"Webhook de mudan√ßa de estado de documento‚Äã","type":1,"pageTitle":"Webhooks ilink","url":"/en/docs/webhooks-ilink#webhook-de-mudan√ßa-de-estado-de-documento","content":" O webhook de mudan√ßa de estado de documento √© uma alternativa √† consulta frequente dos estados de cada documento emitido por parte da entidade emissora. Cada vez que o receptor do um documento emitido aceitar, recusar ou receber o mesmo, este callback ser√° invocado.  O endpoint implementado dever√° esperar os seguintes dados desta especifica√ß√£o. ","version":"Next","tagName":"h3"},{"title":"Onboarding FEAP","type":0,"sectionRef":"#","url":"/en/docs/onboarding-feap","content":"","keywords":"","version":"Next"},{"title":"Quais os organismos da Administra√ß√£o P√∫blica (AP) obrigados a utilizar a solu√ß√£o FE-AP?‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#quais-os-organismos-da-administra√ß√£o-p√∫blica-ap-obrigados-a-utilizar-a-solu√ß√£o-fe-ap","content":" ‚ÄãOs contraentes p√∫blicos vinculados √† utiliza√ß√£o da solu√ß√£o FE-AP fornecida pela eSPap s√£o:  os organismos da Administra√ß√£o direta do Estado, ou seja, todos os √≥rg√£os, servi√ßos e agentes integrados na pessoa coletiva Estado, por exemplo, Dire√ß√µes-Gerais, Dire√ß√µes Regionais, Secretarias Gerais, DGEstE, ASAE, AT, IGF, entre outras;os institutos p√∫blicos, por exemplo, o IAPMEI, o INEM, o IPDJ, o ISS, a pr√≥pria eSPap, entre outros.  Consulte a lista de TODAS as entidades p√∫blicas atualmente a usar o FE-AP.  ","version":"Next","tagName":"h2"},{"title":"Como podem os fornecedores da AP aderir √† solu√ß√£o FE-AP?‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#como-podem-os-fornecedores-da-ap-aderir-√†-solu√ß√£o-fe-ap","content":" Os utilizadores do ilink podem efetuar o envio autom√°tico de fatura√ß√£o eletr√≥nica directamente para o FE-AP ap√≥s a conclus√£o do processo de ades√£o e onboarding da eSPap.  Em suma, existem 3 passos:  ","version":"Next","tagName":"h2"},{"title":"1. Formul√°rio de ades√£o‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#1-formul√°rio-de-ades√£o","content":" Preenchimento do formul√°rio de ades√£o de fornecedores.  P√°gina inicial. Premir Pedido de Ades√£o Preencher os dados da vossa empresa (todos os campos assinalados s√£o obrigat√≥rios)  Nota: No caso de representar mais do que uma entidade fiscal, devem descarregar o template e preencher o mesmo no passo 1.2:  Preencher com os dados da vossa empresa (respons√°vel que ir√° dar seguimento √† fatura√ß√£o eletr√≥nica) Responder que v√£o utilizar um broker Identificar o broker ACIN, bem como o respons√°vel do projeto no passo seguinte e marcar a autoriza√ß√£o Inserir um email para receber as notifica√ß√µes de entrega dos documentos e carregar um exemplo de uma fatura e uma nota de cr√©dito reais Passo final: consentir e enviar Receber o email de confirma√ß√£o e ID de projeto, que ser√° solicitado na fase final do projeto.  ","version":"Next","tagName":"h3"},{"title":"2. Testes‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#2-testes","content":" Ap√≥s a valida√ß√£o pela equipa da eSPap, o fornecedor √© contactado pela eSPap com email que informa o seu ID de projeto e a data de in√≠cio dos testes:  O fornecedor dever√° solicitar acessos no ambiente de qualidade (testes) do ilink e emitir diversos documentos para estas entidades de teste. Estes documentos poder√£o ser criados manualmente no ilink mas idealmente recomendamos que sejam integrados directamente a partir do seu software EDI/ERP. Nota: devem enviar sempre o PDF da fatura anexado durante a fase de testes.Ap√≥s o envio destes documentos para as entidades de teste, o fornecedor dever√° informar a equipa do iLink para verificar se os ficheiros foram comunicados com sucesso √† eSPap, e caso contr√°rio, como dever√£o corrigir os documentos.√Ä medida que os documentos s√£o integrados correctamente no ambiente de qualidade da eSPap, o fornecedor ir√° receber e-mails de confirma√ß√£o como este. Nota: dever√£o guardar os IDs obtidos, bem como os documentos que enviaram para testes, pois s√£o necess√°rios para a fase final!  2.1 Preenchimento de campos das faturas nos testes‚Äã  Caso n√£o pretenda criar os documentos manualmente no ilink, pode saltar este passo.  √â altamente recomendado preencher os campos abaixo durante a fase de testes:  N√∫mero de encomenda (deve usar o valor TESTENOTAENCOM1234): Morada de entrega (deve usar a morada presente na fatura) Termos de pagamento (deve usar os termos de pagamento presentes na fatura) Meios de pagamento (deve usar os meios de pagamento presentes na fatura) N√∫mero de compromisso (deve usar o valor TESTECOMPROMISSO1234) PDF do documento (obrigat√≥rio)  ","version":"Next","tagName":"h3"},{"title":"3. Passagem a produ√ß√£o‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#3-passagem-a-produ√ß√£o","content":" Ap√≥s o envio de faturas e notas de cr√©dito v√°lidas e a sua confirma√ß√£o pela equipa do iLink, o fornecedor dever√° preencher o formul√°rio de passagem a produ√ß√£o.  Neste formul√°rio, ter√° de preencher uma lista de documentos que foram usados para os testes: No primeiro passo dever√° identificar o ID do projecto (indicado por email pela ESPAP) bem como o NIF associado ao projeto). Devem depois anexar imagens dos e-mails recebidos onde solicitado no formul√°rio acima (apenas a fatura e a nota de cr√©dito s√£o obrigat√≥rios) No final, devem consentir e submeter o formul√°rio:  Ser√° depois enviado um email de confirma√ß√£o:  ","version":"Next","tagName":"h3"},{"title":"4. Formaliza√ß√£o da ades√£o‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#4-formaliza√ß√£o-da-ades√£o","content":" Ap√≥s confirma√ß√£o da passagem a produ√ß√£o, √© recebido um e-mail da eSPap a pedir para finalizar o processo atrav√©s do seguinte link, onde devem preencher os dados necess√°rios e anexar a documenta√ß√£o requisitada pelo representante legal da empresa:  https://www.feap.gov.pt/Paginas/PedidoAdesao.aspx  Isto conclui a passagem a produ√ß√£o no FE-AP. Ap√≥s valida√ß√£o da eSPap, o processo fica conclu√≠do e entrar√° em produ√ß√£o na data indicada do email. Caso sejam detectadas falhas, a equipa do ilink ir√° entrar em contacto.  ","version":"Next","tagName":"h3"},{"title":"Mais informa√ß√£o‚Äã","type":1,"pageTitle":"Onboarding FEAP","url":"/en/docs/onboarding-feap#mais-informa√ß√£o","content":" Perguntas Frequentes da eSPap  Lista de todos os fornecedores atualmente inscritos no FE-AP ","version":"Next","tagName":"h2"},{"title":"ilink Knowledge Base","type":0,"sectionRef":"#","url":"/en/docs/","content":"","keywords":"","version":"Next"},{"title":"O que √© o ilink?‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#o-que-√©-o-ilink","content":" O ilink √© uma plataforma de integra√ß√£o que permite a comunica√ß√£o eficiente de faturas eletr√≥nicas entre diferentes sistemas e aplica√ß√µes. Com suporte a m√∫ltiplos protocolos e formatos de dados, o ilink facilita a troca de informa√ß√µes de forma segura e confi√°vel.  A plataforma oferece ferramentas para validar, transformar e encaminhar faturas eletr√≥nicas, garantindo conformidade com os requisitos legais e padr√µes do setor. Al√©m disso, disponibiliza funcionalidades de monitoriza√ß√£o e auditoria, permitindo acompanhar o estado das transa√ß√µes e identificar rapidamente quaisquer problemas na comunica√ß√£o entre sistemas.  Clique aqui para consultar a lista de sistemas atualmente integrados com o ilink.  ","version":"Next","tagName":"h2"},{"title":"Enquadramento Legal‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#enquadramento-legal","content":" O diagrama abaixo descreve os prazos para implementar a Fatura√ß√£o Eletr√≥nica na Contrata√ß√£o P√∫blica em Portugal:    Ver Enquadramento Legal em detalhe.  Nota: Para enviar faturas √† FE-AP, √© necess√°rio primeiro registar o fornecedor (e ap√≥s esta valida√ß√£o fica este habilitado a enviar para todas as entidades p√∫blicas do FE-AP). Como efetuar a ades√£o?  ","version":"Next","tagName":"h2"},{"title":"Formatos e normas t√©cnicas‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#formatos-e-normas-t√©cnicas","content":" O ilink utiliza o formato UBL 2.1 na norma t√©cnica CIUS-PT, implementada pela eSPap, e adaptada da Norma Europeia EN16931 para todos os documentos de vendas (Faturas e Notas de Cr√©dito). No caso dos documentos de compra (Encomendas), utilizamos o standard internacional PEPPOLBIS3, tamb√©m baseado em UBL 2.1.  ","version":"Next","tagName":"h2"},{"title":"Tipos de Integra√ß√£o‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#tipos-de-integra√ß√£o","content":" Antes de iniciar o processo de integra√ß√£o, ser√° necess√°rio primeiro decidir o canal mais apropriado para o vosso sistema. Esta documenta√ß√£o cobre os seguintes tipos de integra√ß√µes dispon√≠veis:  ","version":"Next","tagName":"h2"},{"title":"üåê Integra√ß√£o via API REST‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#-integra√ß√£o-via-api-rest","content":" Documenta√ß√£o completa sobre como utilizar as APIs REST do ilink para integra√ß√£o com sistemas web. Inclui instru√ß√µes detalhadas sobre autentica√ß√£o, endpoints dispon√≠veis, formatos de requisi√ß√£o e resposta, exemplos de c√≥digo e boas pr√°ticas de integra√ß√£o.  Vantagens:  √â de f√°cil integra√ß√£o para aplica√ß√µes web, ou programas que permitam comunicar com webservices externosPermite enviar documentos por XML, ou alternativamente enviando o dados do documento em formato estruturado, ficando o ilink respons√°vel pela gera√ß√£o do XML final.Permite aceder a todos os documentos previamente recebidos por um clientePermite alterar o estado de um documento recebido, incluindo a sua aceita√ß√£o, rejei√ß√£o ou regulariza√ß√£oPermite consultar o hist√≥rico dos documentos  ","version":"Next","tagName":"h3"},{"title":"üì° Integra√ß√£o via AS2‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#-integra√ß√£o-via-as2","content":" Guia detalhado para a utiliza√ß√£o do protocolo preferencial de integra√ß√£o por outros brokers EDI, que funciona exclusivamente por transfer√™ncia de ficheiros XML. Obriga √† implementa√ß√£o de um cliente AS2 para a troca de documentos e mensagens de estado. Este guia cobre os procedimentos de envio e rece√ß√£o de documentos.  Vantagens  Standard universalmente aceite de transmiss√£o EDI√â de r√°pida implementa√ß√£o caso o sistema a integrar j√° possua um cliente AS2 funcionalImplementa mecanismos adicionais de seguran√ßa usando certificados embutidos no protocolo de comunica√ß√£oPermite a troca de documentos e mensagens de estado em tempo real, sem necessitar de mecanismos de consultaPermite alterar o estado de um documento (aceitar, rejeitar, regularizar, etc) e enviar esta informa√ß√£o de volta ao emissor do mesmo  Nota: Apenas recomendamos a utiliza√ß√£o deste protocolo caso o vosso sistema j√° o implemente para outros parceiros.  ","version":"Next","tagName":"h3"},{"title":"üîî Webhooks ilink‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#-webhooks-ilink","content":" Como configurar e utilizar webhooks para receber notifica√ß√µes em tempo real sobre eventos do sistema. A sec√ß√£o explica como registar endpoints, configurar tipos de eventos, autenticar chamadas e tratar as notifica√ß√µes recebidas. Inclui exemplos pr√°ticos e boas pr√°ticas para garantir fiabilidade e seguran√ßa na rece√ß√£o de informa√ß√µes em tempo real.  Vantagens  Permite implementar mecanismos de callbacks (Webhooks) em tempo real O emissor pode ser notificado quando um documento muda de estado (aceite, recusado, etc)O receptor pode ser notificado quando recebe um novo documento Mais r√°pido e eficiente que a consulta peri√≥dica de eventosComplementa a integra√ß√£o via REST  ","version":"Next","tagName":"h3"},{"title":"Guias Espec√≠ficos de Integra√ß√£o‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#guias-espec√≠ficos-de-integra√ß√£o","content":" Esta sec√ß√£o detalha como configurar a integra√ß√£o do ilink em algums sistemas em particular. Inclui instru√ß√µes passo a passo e requisitos de configura√ß√£o espec√≠ficos de cada sistema:  ","version":"Next","tagName":"h2"},{"title":"üñ•Ô∏è Integra√ß√£o Moloni‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#Ô∏è-integra√ß√£o-moloni","content":" A integra√ß√£o Moloni permite comunicar os documentos diretamente entre o software Moloni e o ilink.  ","version":"Next","tagName":"h3"},{"title":"üóÇÔ∏è Setup Medidata‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#Ô∏è-setup-medidata","content":" A integra√ß√£o Medidata permite automatizar o envio e rece√ß√£o de documentos nas aplica√ß√µes da suite Medidata via protocolos SFTP. Este guia cont√©m os pr√©-requisitos necess√°rios para permitir a integra√ß√£o com este sistema.  ","version":"Next","tagName":"h3"},{"title":"Ajuda‚Äã","type":1,"pageTitle":"ilink Knowledge Base","url":"/en/docs/#ajuda","content":" Selecione o tipo de integra√ß√£o que deseja implementar no menu lateral para aceder √† documenta√ß√£o espec√≠fica.  Para suporte t√©cnico, entre em contato com a equipa ilink em apoio@ilink.pt ou em 707 451 451. ","version":"Next","tagName":"h2"},{"title":"Integra√ß√£o via AS2","type":0,"sectionRef":"#","url":"/en/docs/integracao-as2","content":"","keywords":"","version":"Next"},{"title":"√Çmbito‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#√¢mbito","content":" A comunica√ß√£o via AS2 √© destinada principalmente a brokers EDI, e facilita a comunica√ß√£o em tempo real de documentos e mensagens de estado. Para iniciar esta interliga√ß√£o, dever√° pedir as nossas credenciais AS2 √† equipa de apoio.  ","version":"Next","tagName":"h2"},{"title":"Detalhes t√©cnicos‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#detalhes-t√©cnicos","content":" Assinatura MDN ativaAlgoritmo de encripta√ß√£o 3DESAlgoritmo de assinatura SHA1MDN as√≠ncronoFormatos suportados: CIUS-PT, CEF Telecom  ","version":"Next","tagName":"h2"},{"title":"Fase de testes‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#fase-de-testes","content":" Ap√≥s configura√ß√£o de credenciais e certificados, normalmente √© feito um teste simples de liga√ß√£o entre os parceiros com um ficheiro de texto.  Ap√≥s essa fase, procede-se ao envio de documentos reais no ambiente de testes, passando a produ√ß√£o ap√≥s a valida√ß√£o dos documentos e mensagens de estado. Caso o broker j√° esteja integrado com diversos clientes, cada novo cliente pode passar a produ√ß√£o de imediato ap√≥s o pedido de liga√ß√£o.  ","version":"Next","tagName":"h2"},{"title":"Formatos e estados‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#formatos-e-estados","content":" Todos os documentos recebidos pelo ilink s√£o sujeitos √† valida√ß√£o CIUS-PT. Ver validador online.  Nota: Para incluir um ficheiro PDF na fatura, este dever√° ser inserido em base64 encode dentro do elemento AdditionalDocumentReference &gt; Attachment &gt; EmbeddedDocumentBinaryObject. Ver exemplo.  Nota: Podem consultar v√°rios exemplos, bem como toda a especifica√ß√£o do CIUS-PT aqui.  ","version":"Next","tagName":"h2"},{"title":"Mensagem de estado‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#mensagem-de-estado","content":" As respostas ser√£o enviadas via XML CIUS MessageStatus vers√£o 2.1, em que:  O nome do ficheiro enviado pelo ilink segue a estrutura Response_{UUID_MESSAGE_STATUS}O elemento DocumentResponse&gt;DocumentReference&gt;ID inclui o n√∫mero de documento que se refereO elemento DocumentResponse&gt;DocumentReference&gt;UUID inclui o AdditionalDocumentReference&gt;ID[schemeID=AIM] do documento que se refere. Caso n√£o exista, o elemento n√£o √© enviado.  Nota: Caso o documento recebido n√£o consiga ser interpretado (ficheiro corrupto, XML inv√°lido), o ilink ir√° enviar uma mensagem .txt de volta ao emissor com o t√≠tulo igual ao AS2_MESSAGE_ID do documento a que se refere a indicar que o ficheiro recebido n√£o foi lido.  Nota: Caso falhe o envio do MessageStatus, o ilink ir√° tentar novamente no final do dia, e assim sucessivamente at√© o ficheiro ser recebido pelo destinat√°rio.  Abaixo pode consultar um exemplo de um ficheiro de estados:  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;ubl:DocumentStatus xmlns:cac=&quot;urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2&quot; xmlns:cbc=&quot;urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2&quot; xmlns:ubl=&quot;urn:oasis:names:specification:ubl:schema:xsd:DocumentStatus-2&quot;&gt; &lt;cbc:CustomizationID&gt;urn:feap.gov.pt:MSGSTS_CIUS-PT:2.1&lt;/cbc:CustomizationID&gt; &lt;cbc:ID&gt;Response_f02866d2-feeb-4f96-9320-d00507c0018a_6e098568-dfde-4835-87e9-28f6ca1b139d&lt;/cbc:ID&gt; &lt;cbc:IssueDate&gt;2021-04-13&lt;/cbc:IssueDate&gt; &lt;cbc:IssueTime&gt;09:06:41.0000000+01:00&lt;/cbc:IssueTime&gt; &lt;cac:SenderParty&gt; &lt;cac:PartyName&gt; &lt;cbc:Name&gt;ENTIDADE P√öBLICA N¬∫ 156&lt;/cbc:Name&gt; &lt;/cac:PartyName&gt; &lt;cac:PostalAddress&gt; &lt;cac:Country&gt; &lt;cbc:IdentificationCode&gt;PT&lt;/cbc:IdentificationCode&gt; &lt;/cac:Country&gt; &lt;/cac:PostalAddress&gt; &lt;cac:PartyTaxScheme&gt; &lt;cbc:CompanyID&gt;PT614054128&lt;/cbc:CompanyID&gt; &lt;cac:TaxScheme&gt; &lt;cbc:ID&gt;VAT&lt;/cbc:ID&gt; &lt;/cac:TaxScheme&gt; &lt;/cac:PartyTaxScheme&gt; &lt;cac:PartyLegalEntity&gt; &lt;cbc:RegistrationName&gt;ENTIDADE P√öBLICA N¬∫ 156&lt;/cbc:RegistrationName&gt; &lt;/cac:PartyLegalEntity&gt; &lt;/cac:SenderParty&gt; &lt;cac:ReceiverParty&gt; &lt;cac:PartyName&gt; &lt;cbc:Name&gt;Servi√ßos de Consultoria, Lda.&lt;/cbc:Name&gt; &lt;/cac:PartyName&gt; &lt;cac:PostalAddress&gt; &lt;cac:Country&gt; &lt;cbc:IdentificationCode&gt;PT&lt;/cbc:IdentificationCode&gt; &lt;/cac:Country&gt; &lt;/cac:PostalAddress&gt; &lt;cac:PartyTaxScheme&gt; &lt;cbc:CompanyID&gt;PT547570692&lt;/cbc:CompanyID&gt; &lt;cac:TaxScheme&gt; &lt;cbc:ID&gt;VAT&lt;/cbc:ID&gt; &lt;/cac:TaxScheme&gt; &lt;/cac:PartyTaxScheme&gt; &lt;cac:PartyLegalEntity&gt; &lt;cbc:RegistrationName&gt;Servi√ßos de Consultoria, Lda.&lt;/cbc:RegistrationName&gt; &lt;/cac:PartyLegalEntity&gt; &lt;/cac:ReceiverParty&gt; &lt;cac:DocumentResponse&gt; &lt;cac:Response&gt; &lt;cbc:ResponseCode&gt;11&lt;/cbc:ResponseCode&gt; &lt;/cac:Response&gt; &lt;cac:DocumentReference&gt; &lt;cbc:ID&gt;ZM 02/7000009232102&lt;/cbc:ID&gt; &lt;cbc:UUID&gt;f02866d2-feeb-4f96-9320-d00507c0018a&lt;/cbc:UUID&gt; &lt;cbc:IssueDate&gt;2021-03-10&lt;/cbc:IssueDate&gt; &lt;cbc:DocumentTypeCode&gt;380&lt;/cbc:DocumentTypeCode&gt; &lt;/cac:DocumentReference&gt; &lt;/cac:DocumentResponse&gt; &lt;/ubl:DocumentStatus&gt;   ","version":"Next","tagName":"h3"},{"title":"Lista de estados‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#lista-de-estados","content":" Os MessageStatus do ilink incluem os estados EDI definidos pela eSPap no elemento DocumentResponse&gt;Response&gt;ResponseCode:  ACCEPTED - documento passou pela valida√ß√£o de XML e regras de qualidade, e foi integrado no sistema, e foi enviado ao receptorERROR - documento n√£o passou pela valida√ß√£o inicial de qualidade (XML com erros, n√£o cumpre os campos obrigat√≥rios especificados pelo receptor, etc)14 - documento foi recusado pelo receptor e aguarda regulariza√ß√£o (deve ser retificado e reenviado, ou alternativamente submetida uma nota de cr√©dito/d√©bito)22 - documento foi devolvido pelo receptor e dever√° ser anulado. Deve ser emitido novo documento33 - documento foi colocado a pagamento29 - documento pago11 - documento processado pelo receptor (documento foi aceite)30 - nota de cr√©dito aceite pelo receptor  Nota: Os estados ERROR, 14 e 22 incluem a descri√ß√£o do erro em DocumentResponse&gt;Response&gt;Description. Nota: Embora os estados 33 e 29 n√£o sejam enviados pelo ilink, estes podem ser recebidos e interpretados correctamente pelo nosso sistema.  ","version":"Next","tagName":"h3"},{"title":"Fluxo de estados EDI‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#fluxo-de-estados-edi","content":" Tendo em conta os estados descritos acima, estes s√£o os diversos fluxos que um documento pode seguir:  Descri√ß√£o\tProcessoO documento chegou ao ilink e n√£o passou a valida√ß√£o das regras sem√¢nticas do XML ou controlo de qualidade (erro CIUS-PT, campos obrigat√≥rios em falta, liga√ß√£o n√£o existente).\tERROR O documento chegou ao ilink e passou na valida√ß√£o XML, e foi enviado ao receptor.\tACCEPTED O documento chegou ao ilink, validou correctamente e chegou ao destinat√°rio, mas o destinat√°rio n√£o integrou o mesmo no seu sistema e pediu um documento de regulariza√ß√£o (emiss√£o de NC ou re-envio do documento retificado).\tACCEPTED &gt; 14 O documento chegou ao ilink, validou correctamente e chegou ao destinat√°rio, mas o destinat√°rio devolveu o mesmo e obriga √† emiss√£o de um novo documento.\tACCEPTED &gt; 22 O documento chegou ao ilink, validou correctamente e chegou ao destinat√°rio, foi integrado no sistema contabil√≠stico.\tACCEPTED &gt; 11 A Nota de Cr√©dito chegou ao ilink, validou correctamente e chegou ao destinat√°rio, e o destinat√°rio integrou o mesmo no seu sistema contabil√≠stico, para depois proceder ao ajuste de caixa.\tACCEPTED &gt; 30  ","version":"Next","tagName":"h3"},{"title":"Reenvio de documentos‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#reenvio-de-documentos","content":" √â poss√≠vel reenviar um documento ap√≥s retifica√ß√£o do mesmo. Um documento apenas pode ser reenviado se o seu √∫ltimo estado for:  ERROR (Erro de valida√ß√£o ou liga√ß√£o)14 (Regulariza√ß√£o por parte do cliente)  Para os restantes estados, n√£o √© poss√≠vel reenviar um documento e este ser√° rejeitado pelo sistema.  ","version":"Next","tagName":"h3"},{"title":"Assinatura digital‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#assinatura-digital","content":" O protocolo AS2 requer o uso de uma assinatura especifica a aplicar ao n√≠vel do protocolo de transporte, recorrendo-se para tal a S/MIME e usando certificados X.509. A autentica√ß√£o √© feita atrav√©s da compara√ß√£o das chaves p√∫blicas e privadas tanto do emissor como do recetor.  A assinatura ao n√≠vel do documento √© obrigat√≥ria para comunica√ß√µes via web services, sendo que passa a facultativa no caso de comunica√ß√µes via AS2, dado que, no caso deste √∫ltimo canal, a assinatura j√° √© usada ao n√≠vel do S/MIME.  Fonte: Guia de Transmiss√£o de documentos eletr√≥nicos FE-AP, ESPAP-IP  √â tamb√©m verificada a validade da assinatura de todos os documentos recebidos pelo ilink. O seguinte validador pode ser utilizado para verificar a validade da assinatura dos documentos. Os formatos de assinatura reconhecidos pelo ilink s√£o PADES (PDF), ou XMLDSig e XADES-BES enveloped (XML).  ","version":"Next","tagName":"h2"},{"title":"Pedidos de liga√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#pedidos-de-liga√ß√£o","content":" Deve ser enviado um pedido de liga√ß√£o √† equipa do ilink usando o portal de liga√ß√µes quando um cliente do broker externo se pretende ligar a um cliente do ilink, e vice-versa. Este processo √© feito por cada par de clientes a ligar.  Quando a equipa do ilink configura um pedido de liga√ß√£o de outro broker, ir√° ser indicado na nossa resposta as valida√ß√µes adicionais que o nosso cliente exige nos ficheiros recebidos (e.g PDF anexado, n√∫mero de compromisso associado, etc), caso existam.  ","version":"Next","tagName":"h2"},{"title":"Altera√ß√µes de certificados‚Äã","type":1,"pageTitle":"Integra√ß√£o via AS2","url":"/en/docs/integracao-as2#altera√ß√µes-de-certificados","content":" Por norma, os nossos certificados usados na comunica√ß√£o AS2 t√™m a validade de 3 anos. As altera√ß√µes de certificados s√£o informadas aos nossos parceiros com 1 m√™s de anteced√™ncia. ","version":"Next","tagName":"h2"},{"title":"Integra√ß√£o via API REST","type":0,"sectionRef":"#","url":"/en/docs/integracao-api-rest","content":"","keywords":"","version":"Next"},{"title":"1. √Çmbito‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#1-√¢mbito","content":" O API REST do ilink permite um controlo program√°tico das principais opera√ß√µes de documentos presentes no ilink, facilitando a integra√ß√£o com programas externos.  O ilink distingue 2 fluxos principais de integra√ß√£o: rece√ß√£o e emiss√£o de documentos, com respetivo reporte de estados, dos quais poder√£o ser implementados ambos ou apenas um, dependendo das necessidades do software a integrar.  ","version":"Next","tagName":"h2"},{"title":"2. Notas T√©cnicas‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#2-notas-t√©cnicas","content":" O webservice segue a estrutura RESTOs HTTP status codes devolvidos respeitam o RFC 7231Todos os dados enviados (incluindo anexos XML) dever√£o ser representados em UTF-8. Formatos como ANSI, UTF-8 BOM e ISO 8859-1 devem ser evitados de modo a garantir compatibilidade com todos os sistemas recetoresAs respostas (payloads) s√£o devolvidas em formato JSONOs servidores do ilink funcionam exclusivamente por HTTPS, com vers√£o TLS 1.2 (em caso de problemas com a comunica√ß√£o, ver poss√≠veis resolu√ß√µes para Java e C#)A especifica√ß√£o e cliente de demonstra√ß√£o swagger est√° dispon√≠vel aquiExistem 2 ambientes distintos, com URLs base diferentes: Testes/pr√©-produ√ß√£o: https://ilink.acin.pt/ilinktests-api/api/v1/ptProdu√ß√£o: https://ilink.pt/ilink-api/api/v1/pt  Nota: Os documentos emitidos e recebidos via API podem ser consultados no portal de testes do ilink usando as credenciais que vos foram enviadas.  ","version":"Next","tagName":"h2"},{"title":"3. Pr√© requisitos‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#3-pr√©-requisitos","content":" De modo a integrar via API, ser√° necess√°rio primeiro entrar em contacto com a nossa equipa (apoio@ilink.pt) de modo a pedir acessos ao nosso ambiente de testes/qualidade.  Os acessos disponibilizados ser√£o os seguintes:  Um token de plataforma, que identifica o sistema/plataforma a aceder ao webserviceUma chave p√∫blica, que identifica o cliente/NIF que pretende aceder ao webservice  Isto significa que cada cliente que permite emitir ou receber documentos necessita de um pr√©-registo com a nossa equipa, de modo a ser gerada a sua chave p√∫blica. O token de plataforma ser√° √∫nico para o sistema a integrar (comum a todos os clientes que utilizam o vosso sistema), e dever√° ser usado em todas as chamadas ao API.  Nos acessos de teste, tamb√©m s√£o disponibilizados 2 clientes/NIFs, juntamente com os seus logins de acesso ao portal do ilink. Dever√£o usar estas entidades para transacionar documentos entre si, e opcionalmente aceder ao portal para consulta dos mesmos. Os NIFs atribu√≠dos podem ser alterados se necess√°rio.  Nota: Ser√£o enviados novos acessos (token de plataforma e chave p√∫blica por NIF) mediante entrada em produ√ß√£o.  ","version":"Next","tagName":"h2"},{"title":"4. Especifica√ß√£o t√©cnica‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#4-especifica√ß√£o-t√©cnica","content":" Aceder √† especifica√ß√£o swagger  O ilink utiliza uma especifica√ß√£o OpenApi 3, e est√° dispon√≠vel aqui. Neste cliente web, poder√° efetuar chamadas de teste ao nosso API, analisar as respostas obtidas bem como os dados a enviar para cada endpoint/m√©todo.  O cliente swagger disponibilizado acima dever√° acompanhar o vosso processo de desenvolvimento. √â tamb√©m poss√≠vel verificar como as chamadas ao API s√£o constru√≠das via cURL (ver exemplo abaixo):    Nota: S√£o tamb√©m disponibilizados v√°rios clientes HTTP, em mais de 50 linguagens e frameworks, gerados automaticamente a partir da nossa especifica√ß√£o, que poder√£o servir de suporte inicial ao processo de integra√ß√£o.  ","version":"Next","tagName":"h2"},{"title":"4.1 Autoriza√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#41-autoriza√ß√£o","content":" Todos os pedidos a efetuar ao API t√™m de conter obrigatoriamente o header de autoriza√ß√£o abaixo:  Authorization: Bearer {TOKEN_PLATAFORMA}  No cliente Swagger, o processo de autoriza√ß√£o √© feito inserindo o token de plataforma ap√≥s clicar no bot√£o Authorize.    Ap√≥s esta opera√ß√£o, dever√£o notar que todos os pedidos subsequentes ao API incluem o header Authorization:    ","version":"Next","tagName":"h3"},{"title":"4.2 Autentica√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#42-autentica√ß√£o","content":" Antes de efetuar a primeira consulta ao API do ilink, √© obrigat√≥rio efetuar uma autentica√ß√£o por cliente/NIF. Esta autentica√ß√£o serve de handshake inicial entre o cliente e o ilink √© feita com recurso ao endpoint POST /apps/authentications:    Uma autentica√ß√£o v√°lida dever√° retornar esta resposta:  HTTP status: 200 OK { &quot;success&quot;: true, &quot;message&quot;: { &quot;code&quot;:&quot;e123&quot;, &quot;msg&quot;:&quot;Integra√ß√£o realizada com sucesso.&quot; } }   A autentica√ß√£o tem dura√ß√£o ilimitada (s√≥ precisa de ser invocada 1 vez por cliente/NIF que acede ao API). Pode tamb√©m ser revogada atrav√©s do m√©todo DELETE /apps/authentications:    Se o processo de autentica√ß√£o n√£o for conclu√≠do, ou o header Authorization n√£o for enviado nos pedidos ao API, todas as chamadas ser√£o recusadas para esse NIF com um erro:  HTTP status: 401 Unauthorized { &quot;success&quot;: false, &quot;errors&quot;: [ { &quot;code&quot;: &quot;e069&quot;, &quot;msg&quot;: &quot;Autentica√ß√£o inv√°lida&quot; } ] }   Nota: Em ambiente de produ√ß√£o √© necess√°rio autenticar novamente cada cliente/NIF.  ","version":"Next","tagName":"h3"},{"title":"5. Emiss√£o de documentos‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#5-emiss√£o-de-documentos","content":" ","version":"Next","tagName":"h2"},{"title":"5.1 √Çmbito‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#51-√¢mbito","content":" Permite √† plataforma integradora emitir documentos no ilink, que s√£o posteriormente enviados para o seu destinat√°rio. O destinat√°rio dos documentos tem configurado no portal do ilink para que sistemas externos os documentos devem ser remetidos. Isto significa que o processo de envio de documentos aos ERPs e EDIs adequados de cada cliente √© transparente ao API e fica √† responsabilidade do ilink. Estas configura√ß√µes s√£o efetuadas pela equipa de apoio do ilink antes da passagem a produ√ß√£o.  A plataforma ilink permite o envio de faturas eletr√≥nicas em 2 cen√°rios distintos:  Envio de PDF assinado via e-mail para consumidores finais ou empresas privadas Neste cen√°rio, n√£o ser√° necess√°rio criar liga√ß√µes entre outros EDIs para o envio de documentos. Basta indicar ao endpoint de cria√ß√£o de documento o(s) endere√ßo(s) de e-mail a remeter o mesmo. Para mais informa√ß√µes, consulte a sec√ß√£o M√©todos de envio. Envio de XML CIUS-PT para entidades p√∫blicas (obrigat√≥rio nos contratos p√∫blicos) Neste cen√°rio, ser√° necess√°rio configurar previamente as liga√ß√µes entre NIFs e possivelmente entre outros brokers EDI externos.  Como s√£o enviados os documentos para outros brokers EDI?Na fase de passagem a produ√ß√£o, dever√° ser feito um levantamento de todas as entidades que ir√£o receber documentos via EDI, bem como os seus brokers EDI em uso. De seguida, a equipa de apoio (apoio@ilink.pt) ir√° configurar as liga√ß√µes necess√°rias de modo a que os documentos sejam integrados automaticamente no sistema de cada recetor. Antes de enviar documentos para a solu√ß√£o FE-AP da eSPap, ser√° tamb√©m necess√°rio cada emissor de faturas completar o processo de ades√£o de fornecedores FE-AP.  Todos os documentos emitidos ficam dispon√≠veis no portal do ilink tanto na entidade emissora como na entidade recetora dos mesmos.  Nota: No nosso ambiente de testes, devem emitir documentos apenas entre as 2 entidades que receberam acessos. Caso pretendam verificar o funcionamento do envio de documentos para um consumidor final (NIF arbitr√°rio), dever√£o sempre emitir o mesmo por uma das entidades que receberam acessos.  IMPORTANTE: Para o envio de documentos a entidades p√∫blicas, recomendamos fortemente implementar os seguintes campos, sob pena de n√£o integrar os documentos com certos sistemas:  Envio do n√∫mero de compromissoEnvio do ficheiro PDF original da faturaEnvio do n√∫mero de encomenda ou requisi√ß√£o (se aplic√°vel)Envio do Capital Social do fornecedorEnvio do endere√ßo de e-mail do cliente (apenas para as secretarias do Governo Regional da Madeira)Envio de todos os dados da morada do fornecedor (rua, c√≥digo-postal, cidade, etc.)Envio do GLN do cliente (se aplic√°vel)Possibilidade de reenvio do documento mediante o estado obtido (√∫til para corrigir e reenviar um documento previamente rejeitado)  ","version":"Next","tagName":"h3"},{"title":"5.2 Assinatura digital‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#52-assinatura-digital","content":" O ilink permite assinar automaticamente os anexos dos documentos emitidos na plataforma (XML e PDF), desde que a entidade emissora tenha adquirido e configurado o selo de um dos provedores de assinaturas digitais qualificadas. Neste momento, apenas o GTS - Global Trusted Sign √© suportado, mas existem planos de suportar os restantes provedores em Portugal (Multicert e DigitalSign).  Isto significa que o ERP n√£o √© obrigado a integrar com um provedor de assinaturas, deixando (opcionalmente) o processo de certifica√ß√£o √† responsabilidade do ilink. A outra alternativa ser√° o pr√≥prio ERP efetuar o processo de certifica√ß√£o e enviar os documentos previamente assinados para o ilink.  Nota: No cen√°rio de assinatura via ilink, por defeito, todos os ficheiros resultantes ser√£o assinados no momento de entrada (xml e pdf), e s√≥ depois remetidos ao cliente. Este processo √© configurado no portal web, ficando fora da responsabilidade do API.  No caso de assinatura via ERP, a assinatura digital do documento ser√° validada a n√≠vel criptogr√°fico para todos os documentos que entram no sistema, e um documento com assinatura inv√°lida, tanto no XML como no PDF n√£o ir√° integrar e retorna sempre um erro via API como o seguinte:  HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;document&quot;: { &quot;code&quot;: &quot;e217&quot;, &quot;msg&quot;: &quot;A assinatura do documento n√£o √© v√°lida.&quot; } } }   O erro anterior indica que o documento sofreu altera√ß√µes desde o momento que foi assinado, ou que a assinatura do mesmo foi gerada incorretamente. O seguinte validador pode ser utilizado para verificar a validade da assinatura dos documentos. Os formatos de assinatura reconhecidos pelo ilink s√£o PADES e PKCS7-B (PDF), ou XMLDSig e XADES-BES (XML).  Nota: Os requisitos legais de assinatura das faturas eletr√≥nicas est√£o dispon√≠veis no Decreto-Lei 28/2019, sec√ß√£o II, artigo 12¬∫.  Nota: O ilink assina os documentos PDF em PADES e os documentos XML em XADES-BES enveloped.  ","version":"Next","tagName":"h3"},{"title":"5.3 M√©todos de envio‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#53-m√©todos-de-envio","content":" Ap√≥s efetuada a autentica√ß√£o com sucesso, estamos em condi√ß√µes de come√ßar a enviar documentos. O API do ilink possibilita 2 m√©todos de envio de documentos:  a) Envio do XML em formato UBL 2.1 CIUS-PT (ou UBL 2.1 PEPPOLBIS3 - Encomendas)‚Äã  Neste m√©todo, o sistema a integrar tem de gerar corretamente o ficheiro XML antes de enviar o mesmo ao ilink. Todos os ficheiros XML enviados por este m√©todo s√£o verificados de acordo com o validador oficial da eSPap, vers√£o 2.1.2, e o API ir√° retornar um erro caso se verifiquem inconsist√™ncias sint√°ticas. A eSPap disponibiliza um validador Schematron que implementa todas as valida√ß√µes da Norma Europeia EN16931 CIUS e as valida√ß√µes adicionais do CIUS-PT, e est√° dispon√≠vel online neste link. Se os ficheiros validam sintaticamente no validador online, ent√£o dever√£o validar no ilink, com a exce√ß√£o de valida√ß√µes adicionais colocadas pelo destinat√°rio do documento.  Nota: Para incluir um ficheiro PDF na fatura eletr√≥nica e consultar outros casos de uso, consultar a sec√ß√£o casos de uso.  Nota: Podem consultar v√°rios exemplos do CIUS-PT, bem como toda a especifica√ß√£o do CIUS-PT aqui.  Alguns exemplos de erros no processo de valida√ß√£o XML:  HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;document&quot;: { &quot;code&quot;: &quot;e217&quot;, &quot;msg&quot;: &quot;[BR-CO-25]-Caso o valor a pagar (BT-115) seja positivo, deve indicar a data de vencimento (BT-9) ou a nota da condi√ß√£o de pagamento (BT-20).&quot; } } }   HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;document&quot;: { &quot;code&quot;: &quot;e217&quot;, &quot;msg&quot;: &quot;[DT-CIUS-PT-166]-Amount due for payment (BT-115) = Invoice total amount with VAT (BT-112) -Paid amount (BT-113) +Rounding amount (BT-114), with an acceptance range of 1.00 ‚Ç¨ (it does not mean that this tolerance is accepted by the customer).&quot; } } }   O m√©todo a utilizar para envio do XML √© o POST /apps/documentsUBL. Neste contexto, a chave p√∫blica identifica o emissor do documento e tem de ser a chave associada ao NIF do emissor do documento especificado no XML (AccountingSupplierParty&gt;Party&gt;PartyTaxScheme&gt;CompanyID para faturas/notas de cr√©dito, ou AccountingCustomerParty&gt;Party&gt;PartyTaxScheme&gt;CompanyID para encomendas). Caso isto n√£o se verifique, o API ir√° retornar o seguinte erro:  HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;supplier&quot;: { &quot;code&quot;: &quot;e199&quot;, &quot;msg&quot;: &quot;A entidade criadora do documento deve ser cliente ou fornecedor do novo documento.&quot; } } }   Se o XML for v√°lido e respeitar todas as valida√ß√µes da norma, bem como todas as regras de neg√≥cio adicionais do recetor, o API devolve uma resposta de sucesso, juntamente com os dados principais do documento criado:  HTTP status: 201 Created { &quot;success&quot;: true, &quot;message&quot;: { &quot;code&quot;: &quot;s011&quot;, &quot;msg&quot;: &quot;Documento criado com sucesso&quot; }, &quot;response&quot;: { &quot;data&quot;: { &quot;id&quot;: &quot;60796c3c2a6fa2.53909016&quot;, &quot;number&quot;: &quot;7411111&quot;, &quot;emission_date&quot;: &quot;2021-04-15&quot;, &quot;type_document_fact&quot;: { &quot;id&quot;: &quot;5c9cb870a5ef57.36583702&quot;, &quot;code&quot;: &quot;380&quot;, &quot;alias&quot;: &quot;invoice&quot;, &quot;type&quot;: &quot;FT&quot;, &quot;description&quot;: &quot;Fatura&quot; }, &quot;type_document&quot;: { &quot;alias&quot;: &quot;issued&quot;, &quot;description&quot;: &quot;Emitido&quot; }, &quot;state_document&quot;: { &quot;id&quot;: &quot;5c9cb878745b16.4225687&quot;, &quot;alias&quot;: &quot;sent&quot;, &quot;description&quot;: &quot;Enviado ao cliente.&quot; } } } }   Nota: Um documento √© enviado com sucesso ao destinat√°rio via EDI quando o campo state_document.alias tem o valor sent ou accepted. Caso se apenas pretenda que o documento seja enviado via e-mail, o estado do documento deve ser ignorado, e devemos alternativamente consultar os e-mails enviados atrav√©s da consulta de estado do mesmo.  b) Envio dos dados estruturados do documento‚Äã  Ao adotar esta op√ß√£o, o ERP dispensa de efetuar a gera√ß√£o completa do XML, ficando assim o ilink respons√°vel por gerar o XML final. Assim, o ERP apenas necessita de enviar ao ilink todos os dados referentes ao documento. O endpoint a adotar aqui ser√° o POST /apps/documents    A especifica√ß√£o deste m√©todo √© extensa, pois cobre todos os campos poss√≠veis de uma fatura/encomenda, que est√£o devidamente documentados acima. Todos os documentos criados por este endpoint est√£o sujeitos √†s mesmas valida√ß√µes que os documentos enviados pelo m√©todo POST /apps/documentsUBL, ou seja, o XML resultante dos dados inseridos ser√° validado de acordo com o validador oficial da eSPap, que pode ser consultado online neste link, e segundo as regras de neg√≥cio adicionais do recetor do documento, caso existam.  Nota: Para incluir um ficheiro PDF e outras situa√ß√µes habituais, consultar a sec√ß√£o casos de uso.  Nota: √â poss√≠vel enviar v√°rios anexos num documento atrav√©s do campo files[] (ver especifica√ß√£o acima). Contudo, a representa√ß√£o visual do documento (i.e PDF original da fatura usado na impress√£o) deve ser enviado sempre no campo file, sendo o campo files[] reservado para ficheiros adicionais (notas de encomenda, avisos de despacho, guias de transporte, etc.). Se o emissor do documento tem uma assinatura digital ativa no ilink, todos os anexos ser√£o assinados por defeito.  ","version":"Next","tagName":"h3"},{"title":"5.4 Envio do documento‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#54-envio-do-documento","content":" 5.4.1 Envio via EDI‚Äã  Um documento, ap√≥s cria√ß√£o com sucesso por qualquer um dos m√©todos acima (envio de XML ou envio de dados), ser√° enviado automaticamente ao destinat√°rio por EDI. Contudo, em casos pontuais, este poder√° n√£o ser entregue imediatamente ao destinat√°rio via EDI devido a configura√ß√µes em falta e/ou outras anomalias na plataforma ilink ou no sistema do recetor. Caso isto se verifique, ser√° devolvido um campo to_send_status na resposta do documento a detalhar a situa√ß√£o:  HTTP status: 201 OK { &quot;success&quot;: true, &quot;message&quot;: { &quot;code&quot;: &quot;s011&quot;, &quot;msg&quot;: &quot;Documento criado com sucesso&quot; }, &quot;response&quot;: { &quot;data&quot;: { &quot;id&quot;:&quot;60796c3c2a6fa2.53909016&quot;, &quot;state_document&quot;: { &quot;id&quot;: &quot;5c9cb870f34b16.42025494&quot;, &quot;alias&quot;: &quot;tosend&quot;, &quot;description&quot;: &quot;Por enviar ao cliente.&quot; }, &quot;to_send_status&quot;: { &quot;code&quot;: &quot;sent_connection&quot;, &quot;title&quot;: &quot;Aguardar a aceita√ß√£o de liga√ß√£o com o destinat√°rio do documento.&quot; } } } }   Nota: Pode-se verificar que o documento N√ÉO foi entregue via EDI pois o campo state_document.alias assume o valor tosend e o motivo de erro encontra-se descrito no campo to_send_status. Nesta situa√ß√£o, √© necess√°rio primeiro concluir a liga√ß√£o EDI com o destinat√°rio e depois proceder ao reenvio.  Os motivos poss√≠veis (code) para um documento n√£o ser entregue s√£o:  sent_connection, no_connection: Liga√ß√£o com o destinat√°rio em faltaregistered_entity: O destinat√°rio n√£o est√° registado no ilinkreceived_pay_transactions: O destinat√°rio suporta os custos dos documentos recebidos mas n√£o disp√µe de transa√ß√µes suficientes para o envio do documento  Ap√≥s regularizar a situa√ß√£o de erro, ser√° poss√≠vel enviar o documento novamente (ver sec√ß√£o de [reenvio de documentos]#56-criareditar-documento).  Nota: O estado do documento (state_document) √© apenas aplic√°vel a envios EDI. Caso o documento seja enviado para um cliente arbitr√°rio via e-mail (PDF), o estado de envio n√£o reflete o envio do e-mail (ver sec√ß√£o seguinte).  5.4.2 Envio via e-mail‚Äã  Um documento, ap√≥s cria√ß√£o com sucesso (HTTP status 201) por qualquer um dos m√©todos acima (envio de XML ou envio de dados), ser√° remetido via e-mail ao destinat√°rio caso seja especificado o campo send_by_email com o valor 1. O(s) endere√ßo(s) do(s) recetor(es) do documento pode(m) ser especificado(s) de 3 modos:  no campo additional_emails[] (em ambos os m√©todos de envio)no campo customer[email] (apenas no m√©todo de envio de dados)no elemento cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:ElectronicMail do XML (apenas no m√©todo de envio de XML).  Para consultar o envio dos e-mails e leitura dos mesmos para o cliente, ver sec√ß√£o b) de consulta de estado de documentos emitidos.  5.4.3 Cria√ß√£o de documentos e consumo de assinaturas digitais qualificadas‚Äã  Esta sec√ß√£o √© apenas relevante para clientes que utilizam o ilink para assinar digitalmente os documentos. Ver detalhes.  Caso esteja configurada uma assinatura digital qualificada no ilink, todos os documentos ser√£o assinados no momento da sua cria√ß√£o, incluindo todos os ficheiros resultantes da fatura eletr√≥nica (xml e pdf). Dado que a assinatura dos documentos n√£o √© obrigat√≥ria por lei em todos os cen√°rios de utiliza√ß√£o, √© poss√≠vel controlar individualmente a assinatura dos ficheiros xml e pdf no momento da cria√ß√£o do documento com recurso aos os campos disable_xml_sign e disable_pdf_sign, dispon√≠veis em ambos os m√©todos de cria√ß√£o de documento (XML ou dados). Isto permite reduzir o consumo de assinaturas, bem como otimizar o processo de cria√ß√£o de documentos.  Ou seja:  No envio de fatura digital via PDF assinado para um consumidor final ou cliente privado, n√£o ser√° obrigat√≥rio assinar o ficheiro XML resultante, pelo que recomendamos a utiliza√ß√£o do campo disable_xml_sign: 1.No envio de fatura eletr√≥nica para a Administra√ß√£o P√∫blica via EDI (exemplo eSPap), n√£o √© obrigat√≥rio assinar o documento, no entanto recomenda-se a assinatura de ambos os ficheiros por motivos de seguran√ßa adicional e integridade.Os campos acima apenas t√™m efeito quando o emissor do documento usa uma assinatura digital qualificada no ilink.  ","version":"Next","tagName":"h3"},{"title":"5.5 Valida√ß√µes adicionais‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#55-valida√ß√µes-adicionais","content":" O recetor da fatura pode configurar no ilink requisitos adicionais para determinados campos (regras de neg√≥cio), mesmo quando estes n√£o s√£o obrigat√≥rios na especifica√ß√£o CIUS-PT. Por exemplo, um cliente pode definir que apenas aceita faturas com o ficheiro PDF em anexo ou com o n√∫mero de compromisso especificado. √â fundamental que estes requisitos sejam acordados previamente com o cliente/destinat√°rio antes da entrada em produ√ß√£o, de forma a evitar erros de integra√ß√£o.  Caso o recetor do documento obrigue a presen√ßa de algum campo n√£o especificado no XML, o API ir√° retornar um erro como abaixo e o documento n√£o ser√° gerado:  HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;commitment_number&quot;: { &quot;code&quot;: &quot;e048&quot;, &quot;msg&quot;: &quot;O n√∫mero de compromisso √© obrigat√≥rio.&quot; } } }   ","version":"Next","tagName":"h3"},{"title":"5.6 Criar/editar documento‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#56-criareditar-documento","content":" Um documento pode ser editado e reenviado ao destinat√°rio  se ainda n√£o foi enviado ao cliente finalou se j√° foi enviado ao cliente e o cliente pediu uma regulariza√ß√£o do mesmo  Em termos pr√°ticos, a possibilidade de reenvio pode ser consultada atrav√©s do campo de resposta seguinte do documento:  &quot;state_edi_document&quot;: { &quot;alias&quot;: &lt;estado&gt; // estados poss√≠veis de reenvio: 'regularization' ou 'reception' ou 'error' }   Para consultar o estado de um documento, ver sec√ß√£o de consulta de estado de documentos emitidos.  Para editar um documento existente, basta repetir o pedido POST /apps/documentsUBL ou POST /apps/documents com os dados corrigidos, mantendo o n√∫mero, tipo e data de emiss√£o do documento anterior:  HTTP status: 200 OK { &quot;success&quot;: true, &quot;message&quot;: { &quot;code&quot;: &quot;s012&quot;, &quot;msg&quot;: &quot;Documento editado com sucesso&quot; }, &quot;response&quot;: { &quot;data&quot;: { &quot;id&quot;: &quot;60796c3c2a6fa2.53909016&quot;, &quot;number&quot;: &quot;7411111&quot;, &quot;emission_date&quot;: &quot;2021-04-16&quot;, &quot;type_document_fact&quot;: { &quot;id&quot;: &quot;5c9cb870a5ef57.36583702&quot;, &quot;code&quot;: &quot;380&quot;, &quot;alias&quot;: &quot;invoice&quot;, &quot;type&quot;: &quot;FT&quot;, &quot;description&quot;: &quot;Fatura&quot; }, &quot;type_document&quot;: { &quot;alias&quot;: &quot;issued&quot;, &quot;description&quot;: &quot;Emitido&quot; }, &quot;state_document&quot;: { &quot;id&quot;: &quot;5c9cb870f34b16.42025494&quot;, &quot;alias&quot;: &quot;tosend&quot;, &quot;description&quot;: &quot;Por enviar ao cliente.&quot; } } } }   Caso o documento n√£o seja eleg√≠vel para edi√ß√£o (i.e j√° foi enviado ou foi aceite pelo cliente final), ser√° apresentado um erro ao tentar reenviar:  HTTP status: 400 Bad request { &quot;success&quot;: false, &quot;errors&quot;: { &quot;number&quot;: { &quot;code&quot;: &quot;e200&quot;, &quot;msg&quot;: &quot;Documento j√° existe.&quot; } } }   ","version":"Next","tagName":"h3"},{"title":"5.7 Acesso a documentos emitidos‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#57-acesso-a-documentos-emitidos","content":" Quando um documento √© registado com sucesso, ser√° sempre devolvido um id nas respostas, que identifica o mesmo perante o ilink. √â √∫til guardar este identificador para consultas futuras ao documento.  HTTP status: 201 Created { &quot;success&quot;: true, &quot;message&quot;: { &quot;code&quot;: &quot;s011&quot;, &quot;msg&quot;: &quot;Documento criado com sucesso&quot; }, &quot;response&quot;: { &quot;data&quot;: { &quot;id&quot;: &quot;60796c3c2a6fa2.53909016&quot; } } }   O API permite tamb√©m aceder a todos os dados (inclusive ao XML e PDF gerados) de todos os documentos previamente emitidos. Para tal, dever√£o usar o m√©todo GET /apps/documents/{id}. O id recebido na cria√ß√£o do documento deve ser usado como par√¢metro aqui para aceder ao documento em quest√£o.  Todos os dados retornados por este m√©todo est√£o dispon√≠veis na especifica√ß√£o acima.  Nota: Caso a entidade emissora do documento tenha configurado a assinatura autom√°tica de documentos no ilink, os URLs de acesso ao XML e ao PDF j√° retornam os ficheiros assinados.  ","version":"Next","tagName":"h3"},{"title":"5.8 Consulta de documentos emitidos no portal (opcional)‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#58-consulta-de-documentos-emitidos-no-portal-opcional","content":" Os documentos podem tamb√©m ser consultados no portal de testes do ilink usando as credenciais das entidades que vos foram enviadas. Aqui podem validar visualmente se a informa√ß√£o apresentada est√° coerente com os dados enviados via API:    Para aceder aos anexos de um documento, dever√£o aceder ao documento da tabela acima, e aceder ao √≠cone da lupa:    Nota: Os documentos dever√£o estar presentes tanto na entidade emissora (sec√ß√£o de documentos emitidos), bem como na entidade recetora (sec√ß√£o de documentos recebidos).  ","version":"Next","tagName":"h3"},{"title":"5.9 Consulta de estado de documentos emitidos‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#59-consulta-de-estado-de-documentos-emitidos","content":" √â tamb√©m poss√≠vel aceder ao estado atual dos documentos previamente emitidos. Esta opera√ß√£o permite ao emissor do documento consultar se o documento foi aceite pelo cliente, ou se est√° pendente de reenvio/regulariza√ß√£o, bem como os motivos que levaram a tal.  5.9.1 Consulta de estado de documento enviado via EDI‚Äã  O ilink contempla 4 estados simplificados de documento na propriedade state_document:  Por enviar (tosend) - o documento n√£o foi enviado ao cliente. Provavelmente significa que falta alguma configura√ß√£o no ilink, emissor/recetor n√£o autorizam liga√ß√£o entre eles, ou que alguma das entidades presentes no documento n√£o tem transa√ß√µes suficientes para proceder ao envio.Enviado (sent) - o documento foi enviado ao cliente e est√° pendente de aceita√ß√£o.Aceite (accepted) - o documento foi enviado e o cliente aceitou o mesmo. Estado final.Recusado (rejected) - o documento foi enviado e o cliente rejeitou o mesmo devido a uma incoer√™ncia. O motivo de recusa √© disponibilizado na resposta no campo reasons. O documento poder√° ser enviado novamente caso seja solicitada uma regulariza√ß√£o do mesmo.  Nota: O ilink devolve tamb√©m o estado de processamento EDI atual do documento (state_edi_document), que √© independente dos estados acima. Para mais informa√ß√£o, consultar o Guia de Transmiss√£o de Documentos FE-AP, p√°gina 7. Contudo, a leitura do estado EDI nem sempre √© relevante para os softwares de fatura√ß√£o.  Existem 3 abordagens para aceder ao estado de um documento previamente emitido: Consulta individual, Webhook de mudan√ßa de estado e Reporte de estados.  Na Consulta individual de estado, basta efetuar a chamada GET /apps/documents/{id}. O id recebido na cria√ß√£o do documento deve ser usado como par√¢metro para aceder ao documento em quest√£o. O estado √© devolvido no campo state_document (ver especifica√ß√£o acima). Este m√©todo apenas permite consultar o estado de um documento de cada vez, e como tal n√£o √© recomendado para clientes que emitem um volume elevado de documentos. No Webhook de mudan√ßa de estado, o ilink tem a iniciativa de informar ao emissor do documento cada vez que o mesmo muda de estado. Esta √© a op√ß√£o recomendada em termos de desempenho e rapidez, mas pode n√£o ser vi√°vel caso o sistema a integrar perten√ßa a numa rede n√£o exposta publicamente ao ilink. Para mais informa√ß√£o, consultar a sec√ß√£o Webhooks. No Reporte de estados, a aplica√ß√£o a integrar tem a iniciativa de consultar os diversos eventos que levaram √†s altera√ß√µes de estado dos documentos emitidos. Para tal, basta efetuar a chamada GET /apps/states-report/documents. Cada evento identifica o documento e o estado alterados. √â poss√≠vel filtrar os eventos retornados por id de documento, n√∫mero de documento, intervalos de datas, entre outros (ver especifica√ß√£o acima). Este m√©todo permite a aplica√ß√£o consultar o estado de v√°rios documentos em simult√¢neo. De modo a facilitar a utiliza√ß√£o do reporte de estados, √© adicionalmente disponibilizado o endpoint de leitura de eventos POST /apps/states-report/documents/read, que permite marcar um ou mais ids de evento obtidos acima como lido(s). Os eventos marcados como lidos n√£o s√£o retornados novamente no endpoint de reporte de estados, facilitando a consulta futura. Esta op√ß√£o √© uma alternativa escal√°vel para os sistemas que n√£o podem implementar Webhooks.  5.9.2 Consulta de estado de documento enviado via e-mail‚Äã  No cen√°rio de envio de documentos por e-mail, √© poss√≠vel consultar o registo de envio e de leitura dos e-mails enviados ao cliente. Note-se que o estado do documento retornado (state_document) n√£o √© aplic√°vel neste cen√°rio, pois o documento por norma n√£o √© enviado via EDI, e como tal, o seu estado de envio ser√° habitualmente to_send. Este estado deve ser ignorado a favor das abordagens abaixo.  Existem duas abordagens para aceder ao registo de e-mails enviados de um documento: Consulta individual e Consulta de hist√≥rico de documento.  Na Consulta individual, basta efetuar a chamada GET /apps/documents/{id}. O id recebido na cria√ß√£o do documento deve ser usado como par√¢metro para aceder ao documento em quest√£o. Na resposta, devem aceder √† propriedade emails, que retorna uma lista das mensagens enviadas e o seu estado de rece√ß√£o e leitura. Este m√©todo apenas permite consultar o estado de um documento de cada vez e tem as mesmas limita√ß√µes que a consulta individual de documentos da sec√ß√£o anterior:  HTTP status: 200 OK { &quot;success&quot;: true, &quot;response&quot;: { &quot;data&quot;: { &quot;id&quot;: &quot;60796c3c2a6fa2.53909016&quot;, ... &quot;emails&quot;: [ { &quot;id&quot;: &quot;634672bab0f3b8.40302642&quot;, &quot;b_open&quot;: true, // true caso o email tenha sido lido pelo recetor &quot;b_sent&quot;: true, // true caso o email tenha sido enviado com sucesso &quot;created_at&quot;: &quot;2022-10-12 08:54:34&quot;, // data e hora de envio do email &quot;opened_at&quot;: &quot;2022-10-12 09:14:16&quot;, // data e hora de leitura do email &quot;address&quot;: { &quot;emails&quot;: [&quot;joao.freitas@email.com&quot;], // endere√ßo de envio } } ] } } }   Nota: Certos clientes de e-mail (Outlook, etc.) podem bloquear o registo de leitura dos e-mails, ficando o b_open a false mesmo que o e-mail tenha sido aberto em algumas situa√ß√µes.  Na Consulta de hist√≥rico de documento √© poss√≠vel consultar todas as altera√ß√µes processuais de um determinado documento. Este hist√≥rico ir√° listar todas as altera√ß√µes de estado que ocorreram no documento por ordem cronol√≥gica, bem como os registos dos envios de e-mail para o destinat√°rio, o que permite um rastreio completo de auditoria. Pode ser acedido atrav√©s de GET /apps/documents/{id}/history.  ","version":"Next","tagName":"h3"},{"title":"6. Rece√ß√£o de documentos‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#6-rece√ß√£o-de-documentos","content":" ","version":"Next","tagName":"h2"},{"title":"6.1 √Çmbito‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#61-√¢mbito","content":" Esta funcionalidade permite dar entrada autom√°tica aos documentos de fatura√ß√£o no sistema ERP do recetor, facilitando a integra√ß√£o direta nos sistemas contabil√≠sticos. Adicionalmente, possibilita a comunica√ß√£o dos estados de aceita√ß√£o dos documentos ao respetivo emissor (pago, aceite, recusado, entre outros).  Neste fluxo de integra√ß√£o, recomendamos que sejam implementados os seguintes aspetos:  Leitura e processamento de dados: Extrair informa√ß√µes do XML ou dados estruturados do documento para registar corretamente as informa√ß√µes necess√°rias no ERPComunica√ß√£o do estado de integra√ß√£o: Informar o ilink sobre o estado do processo de integra√ß√£o do documentoGest√£o do estado de aceita√ß√£o: Comunicar o estado de aceita√ß√£o do documento, incluindo o envio de mensagens detalhadas em caso de erro ou rejei√ß√£o  ","version":"Next","tagName":"h3"},{"title":"6.2 M√©todos de rece√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#62-m√©todos-de-rece√ß√£o","content":" Permite consultar e integrar documentos no sistema em quest√£o. A rece√ß√£o de documentos pode ser efetuada por 2 m√©todos: Consulta manual de documentos ou Webhook de rece√ß√£o.  a) Consulta manual de documentos  Neste modo, √© necess√°rio aceder ao endpoint GET /apps/documents. √â poss√≠vel especificar diversos par√¢metros de pesquisa de modo a filtrar os resultados obtidos. A resposta deste m√©todo inclui os dados principais dos documentos, e adicionalmente a pagina√ß√£o atrav√©s das propriedades rows (n√∫mero de elementos por p√°gina) e page (n√∫mero da p√°gina a consultar). Consulte a especifica√ß√£o acima para mais detalhes.  Para consultar os detalhes de um documento, bem como os links para os ficheiros XML e PDF do mesmo, dever√° ser utilizado o m√©todo GET /apps/documents/{id}, usando um dos IDs retornados na lista de documentos anterior.  O endpoint de consulta pode ser acedido periodicamente (num processo em segundo plano), ou mediante a consulta de um utilizador no sistema (em tempo real).  Nota: Aqui, a chave p√∫blica √© usada no contexto da entidade recetora dos documentos, ou seja, dever√£o utilizar a chave p√∫blica que identifica a entidade que acede os documentos recebidos.  Importante: Recomendamos uma utiliza√ß√£o respons√°vel deste endpoint. Chamadas excessivas a este recurso s√£o de evitar, e poder√£o levar a 'time-outs' e restri√ß√µes de acesso, consoante o nosso acordo de interoperabilidade.  b) Webhook de rece√ß√£o (recomendado)  Neste modo, o ilink toma a iniciativa de comunicar ao ERP quando chega um novo documento ao cliente, dispensando consultas frequentes ao endpoint GET /apps/documents. Para mais informa√ß√£o, consultar a sec√ß√£o Webhooks.  Nota: Segundo especifica√ß√£o, ser√£o retornados os dados dos documentos recebidos num formato estruturado, bem como os URLs p√∫blicos para o acesso aos ficheiros XML e PDF do documento.  ","version":"Next","tagName":"h3"},{"title":"6.3 Importa√ß√£o e aceita√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#63-importa√ß√£o-e-aceita√ß√£o","content":" Ap√≥s consultar o documento pretendido, √© recomendado que o ERP comunique o estado de processamento do mesmo ao ilink, ou seja, se este integrou corretamete no sistema ou se √© necess√°rio retificar/regularizar o documento. Para tal, s√£o necess√°rios 2 passos:  1. Comunicar o estado do documento √â feito com o pedido POST /apps/documents/{id}/accepted. Aqui √© indicado se o documento foi aceite ou n√£o, e caso contr√°rio, o motivo que levou √† sua rejei√ß√£o√â obrigat√≥rio indicar o motivo de rejei√ß√£o de um documento caso n√£o seja aceiteUm documento rejeitado poder√° ser reenviado pelo emissor com os dados corrigidos 2. Comunicar a importa√ß√£o do documento (apenas na aceita√ß√£o com sucesso) Caso o passo anterior seja conclu√≠do com sucesso (i.e. o documento est√° em condi√ß√µes de ser integrado no ERP), dever√£o invocar o m√©todo POST /apps/documents/{id}  Nota: N√£o √© necess√°rio importar um documento rejeitado.  A correta comunica√ß√£o de documentos aceites e/ou importados cria um hist√≥rico de auditoria e facilita o consumo do API, dado que, caso estejam a adotar a rece√ß√£o de documentos pelo m√©todo de consulta manual, quaisquer documentos que tenham sido importados ou rejeitados n√£o s√£o devolvidos novamente em consultas futuras. Ou seja, as chamadas a GET /apps/documents n√£o devolvem documentos previamente rejeitados ou importados.  A imagem abaixo demonstra como as opera√ß√µes realizadas pelo ERP s√£o registadas no portal do ilink:    ","version":"Next","tagName":"h3"},{"title":"6.4 Estados de Processo (opcional)‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#64-estados-de-processo-opcional","content":" Nota: Esta funcionalidade √© opcional e tem car√°cter meramente informativo, n√£o afectando o processo de recep√ß√£o de documentos.  O ilink permite criar estados de documento personaliz√°veis para os documentos recebidos. Quando esta funcionalidade est√° ativa na entidade, √© poss√≠vel consultar e modificar o estado de um documento atrav√©s da API.  Esta capacidade permite que software externo (como sistemas de gest√£o documental) altere o estado processual do documento no ilink de forma integrada. Todas as altera√ß√µes de estado ficam registadas no hist√≥rico do documento.  Importante: O estado do processo √© independente do estado padr√£o de um documento (recebido, aceite, etc.). Serve exclusivamente para fins de organiza√ß√£o interna e registo de opera√ß√µes.  Para consultar todos os estados de processo dispon√≠veis na entidade em quest√£o, dever√° ser usado o m√©todo GET /apps/processstates, que retorna a lista completa de estados, juntamente com o seu identification_code. Para alterar o estado de processo de um documento, dever√° ser usado o m√©todo PUT /apps/documents/{id}/processstates, usando o campo identification_code para atribuir o novo estado.  Os estados de processo s√£o configurados diretamente pela equipa de apoio do ilink.  ","version":"Next","tagName":"h3"},{"title":"7. Casos de uso‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#7-casos-de-uso","content":" A seguinte sec√ß√£o exemplifica algumas situa√ß√µes comuns na cria√ß√£o de documentos CIUS-PT.  ","version":"Next","tagName":"h2"},{"title":"7.1 Cria√ß√£o de documentos por envio de dados‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#71-cria√ß√£o-de-documentos-por-envio-de-dados","content":" Indicar as condi√ß√µes de pagamento payment_terms[note]: 30 dias Indicar um local de consumo (CPE) numa das linhas do documento lines[0][additional_property][0][name]: CPE lines[0][additional_property][0][value]: PT1234567890 Envio do n√∫mero de compromisso no cabe√ßalho do documento commitment_number: 2021/451 Envio do n√∫mero de compromisso nas linhas do documento lines[0][commitment][number]: 2021/123 lines[0][commitment][line]: 1 Envio do n√∫mero de encomenda references[0][document_type]: order references[0][number]: 1234 Envio do PDF anexado (UTF-8) file: (binary) Envio de outros anexos secund√°rios files[0]: (binary) files[1]: (binary) Nota: O PDF de representa√ß√£o do documento deve ser sempre enviado no campo file. Desconto no cabe√ßalho do documento discounts_charges[0][type]: false // usar true para encargo discounts_charges[0][reason]: desconto comercial discounts_charges[0][percent]: 23.00 discounts_charges[0][tax_code]: NOR discounts_charges[0][amount]: 8.13 // refere-se ao valor sem imposto (ou seja, este desconto √© de 10.00 EUR ap√≥s a aplica√ß√£o de IVA) discount_amount: 8.13 // refere-se ao total de descontos de cabe√ßalho aplicados ao documento (N√ÉO inclui descontos nas linhas) Desconto ou encargo na linha do documento lines[0][discounts_charges][0][type]: false // usar true para encargo lines[0][discounts_charges][0][reason]: desconto comercial // descri√ß√£o textual do desconto lines[0][discounts_charges][0][amount]: 5.00 // refere-se ao valor sem IVA a descontar na linha lines[0][quantity]: 2.000 // quantidade de artigos na linha lines[0][price]: 10.00000000 // pre√ßo unit√°rio do artigo lines[0][amount]: 15.00000000 // o total da linha do documento √© afectado pelo desconto ( (10 * 2) - 5 = 15) lines[0][taxes][0][tax_percent]: 23.000 // taxa de IVA lines[0][taxes][0][tax_amount]: 3.45 // valor do IVA da linha (15 * 0.23) discount_amount: 0.00 // refere-se ao total de descontos de cabe√ßalho aplicados ao documento (N√ÉO inclui descontos nas linhas) Desconto no pre√ßo do artigo lines[0][price_discount][base_amount]: 10.00 // pre√ßo unit√°rio original do artigo antes de aplicar o desconto lines[0][price_discount][amount]: 5.00 // refere-se ao valor sem IVA a descontar no pre√ßo do artigo lines[0][quantity]: 2.000 // quantidade de artigos na linha lines[0][price]: 5.00000000 // pre√ßo do artigo ap√≥s aplica√ß√£o do desconto (10 - 5 = 5) lines[0][amount]: 10.00000000 // o total da linha do documento √© afectado pelo desconto ( (10 - 5) * 2 = 10) lines[0][taxes][0][tax_percent]: 23.000 // taxa de IVA lines[0][taxes][0][tax_amount]: 2.30 // valor do IVA da linha (10 * 0.23) discount_amount: 0.00 // refere-se ao total de descontos de cabe√ßalho aplicados ao documento (N√ÉO inclui descontos nas linhas) Reten√ß√£o na fonte withholding_tax[0][type]: IRF withholding_tax[0][tax_amount]: 10.00 // valor da reten√ß√£o withholding_tax[0][description]: Reten√ß√£o IRS withholding_tax_amount: 10.00 // soma de todas as reten√ß√µes do documento Nota: os totais do documento n√£o s√£o afetados pela reten√ß√£o Isen√ß√£o de IVA na linha lines[0][quantity]: 2.000 // quantidade lines[0][price]: 5.00000000 // pre√ßo unit√°rio lines[0][amount]: 10.00000000 // total da linha sem IVA lines[0][taxes][0][tax_percent]: 0.00 // taxa de IVA lines[0][taxes][0][tax_amount]: 0.00 // valor do IVA da linha lines[0][taxes][0][tax_exemption_reason_code]: M08 // c√≥digo de motivo da AT lines[0][taxes][0][tax_exemption_reason]: IVA - Autoliquida√ß√£o // descritivo do motivo da AT Isen√ß√£o de IVA no desconto ou encargo de cabe√ßalho discounts_charges[0][type]: false // usar true para encargo discounts_charges[0][reason]: desconto comercial // descritivo discounts_charges[0][percent]: 0.00 // percentagem (isento) discounts_charges[0][tax_code]: ISE // isento discounts_charges[0][amount]: 10.00 // valor do desconto discounts_charges[0][tax_exemption_reason]: M08 // c√≥digo de motivo da AT discounts_charges[0][tax_exemption_reason_code]: IVA - Autoliquida√ß√£o // descritivo do motivo da AT Envio da fatua por e-mail a um ou mais endere√ßos send_by_email: 1, customer[email]: endereco1@email.com // enviado sempre para o email especificado no cliente additional_emails[0]: endereco2@email.com // tamb√©m enviado para a lista adicional de endere√ßos additional_emails[1]: endereco3@email.com Envio de c√≥digo QR qr_code: A:500000000*B:123456789*C:PT*D:GT*E:N*F:20190720*G:GT G234CB/50987*H:GTVX4Y8B-50987*I1:0*N:0.00*O:0.00*Q:5uIg*R:9999   ","version":"Next","tagName":"h3"},{"title":"7.2 Cria√ß√£o de documentos por envio do CIUS-PT‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#72-cria√ß√£o-de-documentos-por-envio-do-cius-pt","content":" Envio do n√∫mero de compromisso no cabe√ßalho do documento &lt;Invoice&gt; ... &lt;cbc:AccountingCost&gt;2021/156&lt;/cbc:AccountingCost&gt; &lt;/Invoice&gt; Envio do Capital Social do fornecedor: &lt;Invoice&gt; ... &lt;cac:AccountingSupplierParty&gt; &lt;cac:PartyLegalEntity&gt; &lt;cbc:CompanyLegalForm&gt;2.000.000 EUR&lt;/cbc:CompanyLegalForm&gt; &lt;/cac:PartyLegalEntity&gt; &lt;/cac:AccountingSupplierParty&gt; &lt;/Invoice&gt; Envio do GLN do cliente (usar o schemeID 0088): &lt;Invoice&gt; ... &lt;cac:AccountingCustomerParty&gt; &lt;cbc:EndpointID schemeID=&quot;0088&quot;&gt;123456789&lt;/cbc:EndpointID&gt; &lt;/cac:AccountingCustomerParty&gt; &lt;/Invoice&gt; Envio de ATCUD e QRCODE: &lt;Invoice&gt; ... &lt;cac:AdditionalDocumentReference&gt; &lt;cbc:ID schemeID=&quot;ANG&quot;&gt;AFHOFX-22&lt;/cbc:ID&gt; &lt;!-- Valor ATCUD --&gt; &lt;cbc:DocumentDescription&gt;QR_CODE&lt;/cbc:DocumentDescription&gt; &lt;cac:Attachment&gt; &lt;!-- Texto do QRCODE, em base64 (da sequ√™ncia de carateres, N√ÉO da imagem) --&gt; &lt;cbc:EmbeddedDocumentBinaryObject mimeCode=&quot;text/plain&quot; filename=&quot;QR_CODE.txt&quot;&gt;UVJDT0RF=&lt;/cbc:EmbeddedDocumentBinaryObject&gt; &lt;/cac:Attachment&gt; &lt;/cac:AdditionalDocumentReference&gt; &lt;/Invoice&gt; Indicar o m√©todo de pagamento: &lt;Invoice&gt; ... &lt;cac:PaymentMeans&gt; &lt;cbc:PaymentMeansCode&gt;NU&lt;/cbc:PaymentMeansCode&gt; &lt;/cac:PaymentMeans&gt; &lt;/Invoice&gt; Valores permitidos: C√≥digo\tDescri√ß√£oCC\tCart√£o cr√©dito CD\tCart√£o d√©bito CH\tCheque banc√°rio CI\tCr√©dito document√°rio internacional CO\tCheque ou cart√£o oferta CS\tCompensa√ß√£o de saldos em conta corrente DE\tDinheiro eletr√≥nico (ex.: cart√µes de fidelidade ou pontos) LC\tLetra comercial MB\tRefer√™ncias de pagamento para Multibanco NU\tNumer√°rio OU\tOutros meios n√£o assinalados PR\tPermuta de bens TB\tTransfer√™ncia banc√°ria ou d√©bito direto autorizado TR\tT√≠tulos de compensa√ß√£o extrassalarial (ex.: refei√ß√£o, educa√ß√£o, etc.) Indicar informa√ß√µes de pagamento de cart√£o de d√©bito ou cr√©dito: &lt;Invoice&gt; ... &lt;cac:PaymentMeans&gt; &lt;cbc:PaymentMeansCode&gt;CC&lt;/cbc:PaymentMeansCode&gt; &lt;cac:CardAccount&gt; &lt;cbc:PrimaryAccountNumberID&gt;4211456651233545687&lt;/cbc:PrimaryAccountNumberID&gt; &lt;!-- N√∫mero da conta --&gt; &lt;cbc:NetworkID&gt;04256&lt;/cbc:NetworkID&gt; &lt;!-- Identificador da rede banc√°ria --&gt; &lt;cbc:HolderName&gt;Jo√£o Ferreira&lt;/cbc:HolderName&gt; &lt;!-- Nome do titular --&gt; &lt;/cac:CardAccount&gt; &lt;/cac:PaymentMeans&gt; &lt;/Invoice&gt; Indicar m√©todo de pagamento por transfer√™ncia banc√°ria: &lt;Invoice&gt; ... &lt;cac:PaymentMeans&gt; &lt;cbc:PaymentMeansCode&gt;TB&lt;/cbc:PaymentMeansCode&gt; &lt;cac:PayeeFinancialAccount&gt; &lt;cbc:ID&gt;PT50000700230012345667899&lt;/cbc:ID&gt; &lt;!-- IBAN--&gt; &lt;cbc:Name&gt;Jo√£o&lt;/cbc:Name&gt; &lt;!-- Nome do titular --&gt; &lt;cac:FinancialInstitutionBranch&gt; &lt;cbc:ID&gt;NBxxxx&lt;/cbc:ID&gt; &lt;!--SWIFT --&gt; &lt;/cac:FinancialInstitutionBranch&gt; &lt;/cac:PayeeFinancialAccount&gt; &lt;/cac:PaymentMeans&gt; &lt;/Invoice&gt; Indicar m√©todo de pagamento por refer√™ncia multibanco: &lt;Invoice&gt; ... &lt;cac:PaymentMeans&gt; &lt;cbc:PaymentMeansCode name=&quot;#DESCRIPTION@ATMPAYMENT#156.22#&quot;&gt;#ENTITY@ATMPAYMENT#15652&lt;/cbc:PaymentMeansCode&gt; &lt;!-- Entidade e Valor --&gt; &lt;cbc:PaymentID&gt;#REFERENCE@ATMPAYMENT#156555145#&lt;/cbc:PaymentID&gt; &lt;!-- Refer√™ncia --&gt; &lt;/cac:PaymentMeans&gt; &lt;/Invoice&gt; Indicar uma segunda refer√™ncia multibanco: &lt;Invoice&gt; ... &lt;cbc:Note&gt;#ENTITY@ATMPAYMENT-001#12345#&lt;/cbc:Note&gt; &lt;!-- 2¬™ entidade --&gt; &lt;cbc:Note&gt;#REFERENCE@ATMPAYMENT-001#012345678#&lt;/cbc:Note&gt; &lt;!-- 2¬™ refer√™ncia --&gt; &lt;cbc:Note&gt;#AMOUNT@ATMPAYMENT-001#3264.10#&lt;/cbc:Note&gt; &lt;!--Valor da 2¬™ refer√™ncia --&gt; &lt;cbc:Note&gt;#DESCRIPTION@ATMPAYMENT-001#Valor total do documento, mais valores em atraso#&lt;/cbc:Note&gt; &lt;!-- Descri√ß√£o da 2¬™ refer√™ncia --&gt; &lt;/Invoice&gt; Indicar as condi√ß√µes de pagamento: &lt;Invoice&gt; ... &lt;PaymentTerms&gt; &lt;cbc:Note&gt;30 dias&lt;/cbc:Note&gt; &lt;/PaymentTerms&gt; &lt;/Invoice&gt; Indicar uma nota textual no cabe√ßalho do documento: &lt;Invoice&gt; ... &lt;cbc:Note&gt;Nota cabe√ßalho&lt;/cbc:Note&gt; &lt;/Invoice&gt; Indicar uma nota textual numa das linhas do documento: &lt;Invoice&gt; ... &lt;InvoiceLine&gt; &lt;cbc:Note&gt;Nota linha&lt;/cbc:Note&gt; &lt;/InvoiceLine&gt; &lt;/Invoice&gt; Indicar uma propriedade adicional no documento: &lt;Invoice&gt; ... &lt;cbc:Note&gt;#ADDITIONALPROPERTY#VOUCHER#123#&lt;/cbc:Note&gt; &lt;Invoice&gt; Indicar um local de consumo (CPE) numa das linhas do documento: &lt;cac:InvoiceLine&gt; ... &lt;cac:AdditionalItemProperty&gt; &lt;cbc:Name&gt;CPE&lt;/cbc:Name&gt; &lt;cbc:Value&gt;PT1234567890&lt;/cbc:Value&gt; &lt;/cac:AdditionalItemProperty&gt; &lt;/cac:InvoiceLine&gt; Envio do n√∫mero de encomenda / n√∫mero de requisi√ß√£o &lt;Invoice&gt; ... &lt;cac:OrderReference&gt; &lt;cbc:ID&gt;20159854587&lt;/cbc:ID&gt; &lt;/cac:OrderReference&gt; &lt;/Invoice&gt; Envio do n√∫mero de compromisso nas linhas do documento &lt;cac:InvoiceLine&gt; &lt;cbc:AccountingCost&gt;2020/123&lt;/cbc:AccountingCost&gt; &lt;!-- n√∫mero do compromisso da linha --&gt; ... &lt;cac:Item&gt; &lt;cac:AdditionalItemProperty&gt; &lt;cbc:Name&gt;#LINEID@COMMITMENTLINEREFERENCE#&lt;/cbc:Name&gt; &lt;cbc:Value&gt;1&lt;/cbc:Value&gt; &lt;!-- n√∫mero da linha --&gt; &lt;/cac:AdditionalItemProperty&gt; &lt;/cac:Item&gt; &lt;/cac:InvoiceLine&gt; Envio do PDF anexado (o conte√∫do deve estar em base64) &lt;Invoice&gt; ... &lt;cac:AdditionalDocumentReference&gt; &lt;cbc:ID&gt;1&lt;/cbc:ID&gt; &lt;cbc:DocumentDescription&gt;INVOICE_REPRESENTATION&lt;/cbc:DocumentDescription&gt; &lt;cac:Attachment&gt; &lt;cbc:EmbeddedDocumentBinaryObject mimeCode=&quot;application/pdf&quot; filename=&quot;document&quot;&gt;JVBERi0xLjUNCiW1tbW1DQoxIDAgb2JqDQo8PC9UeXBlL0NhdGFsb2cvUGIvTGF== &lt;/cbc:EmbeddedDocumentBinaryObject&gt; &lt;/cac:Attachment&gt; &lt;/cac:AdditionalDocumentReference&gt; &lt;/Invoice&gt; Ver exemplo Envio de m√∫ltiplos PDFs anexados &lt;Invoice&gt; ... &lt;cac:AdditionalDocumentReference&gt; &lt;cbc:ID&gt;1&lt;/cbc:ID&gt; &lt;!-- O anexo principal deve ter a descri√ß√£o INVOICE_REPRESENTATION', ou 'CREDITNOTE_REPRESENTATION' --&gt; &lt;cbc:DocumentDescription&gt;INVOICE_REPRESENTATION&lt;/cbc:DocumentDescription&gt; &lt;cac:Attachment&gt; &lt;cbc:EmbeddedDocumentBinaryObject mimeCode=&quot;application/pdf&quot; filename=&quot;document.pdf&quot;&gt;JVBERi0xLjUNCiW1tbW1DQoxIDAgb2JqDQo8PC9UeXBlL0NhdGFsb2cvUGIvTGF== &lt;/cbc:EmbeddedDocumentBinaryObject&gt; &lt;/cac:Attachment&gt; &lt;/cac:AdditionalDocumentReference&gt; &lt;cac:AdditionalDocumentReference&gt; &lt;cbc:ID&gt;2&lt;/cbc:ID&gt; &lt;!-- Os anexos secund√°rios (como a nota de encomenda, guias de pagamento, etc.) devem ter a descri√ß√£o 'ATTACHMENT'. √â poss√≠vel incluir v√°rios ATTACHMENTs num documento. --&gt; &lt;cbc:DocumentDescription&gt;ATTACHMENT&lt;/cbc:DocumentDescription&gt; &lt;cac:Attachment&gt; &lt;cbc:EmbeddedDocumentBinaryObject mimeCode=&quot;application/pdf&quot; filename=&quot;document2.pdf&quot;&gt;jUNCiW1tbW1DQoJVBERi0xLjUNCiW1tbW1DQo8PC9UeXBlL0NhUGIvTGF== &lt;/cbc:EmbeddedDocumentBinaryObject&gt; &lt;/cac:Attachment&gt; &lt;/cac:AdditionalDocumentReference&gt; &lt;/Invoice&gt; Envio de outros anexos (QR Code, etc.) (o conte√∫do deve estar em base64) &lt;Invoice&gt; ... &lt;cac:AdditionalDocumentReference&gt; &lt;cbc:ID&gt;2&lt;/cbc:ID&gt; &lt;cbc:DocumentDescription&gt;ATTACHMENT&lt;/cbc:DocumentDescription&gt; &lt;!-- usar QR_CODE para o c√≥digo QR --&gt; &lt;cac:Attachment&gt; &lt;cbc:EmbeddedDocumentBinaryObject mimeCode=&quot;application/txt&quot; filename=&quot;document&quot;&gt;JVBERi0xLjUNCiW1tbW1DQoxIDAgb2JqDQo8PC9UeXBlL0NhdGFsb2cvUGIvTGF== &lt;/cbc:EmbeddedDocumentBinaryObject&gt; &lt;/cac:Attachment&gt; &lt;/cac:AdditionalDocumentReference&gt; &lt;/Invoice&gt; Desconto ou encargo no cabe√ßalho do documentoVer exemplo Desconto ou encargo na linha do documentoVer exemplo Desconto ou encargo no pre√ßo do artigoVer exemplo Reten√ß√£o na fonteVer exemplo Isen√ß√£o de IVA na linha do documentoVer exemplo Isen√ß√£o de IVA no desconto de cabe√ßalho do documentoVer exemplo M√∫ltiplas isen√ß√µes no documentoVer exemplo V√°rios descontos na linhaVer exemplo Ver lista completa de casos de uso CIUS-PT pela eSPap.  ","version":"Next","tagName":"h3"},{"title":"8. Fluxos API‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#8-fluxos-api","content":" A imagem abaixo consolida os fluxos de integra√ß√£o do API do ilink acima descritos:    ","version":"Next","tagName":"h2"},{"title":"9. Checklist pr√©-produ√ß√£o‚Äã","type":1,"pageTitle":"Integra√ß√£o via API REST","url":"/en/docs/integracao-api-rest#9-checklist-pr√©-produ√ß√£o","content":" Antes de passar a integra√ß√£o a ambiente produtivo, devem validar os seguintes pontos:  Acordo de interoperabilidade (obrigat√≥rio)  Dever√° ser assinado e devolvido √† acin  Envio de documentos (no caso da implementa√ß√£o do fluxo de envio)  Verificar se √© poss√≠vel criar um documento entre ambas as entidades de teste sem erros de valida√ß√£o, contendo os seguintes campos: PDF anexadoN√∫mero de compromissoTodos os campos da morada do fornecedor (rua, cidade, c√≥digo postal)Capital social do fornecedorN√∫mero de encomenda/requisi√ß√£oGLN do clienteGLN do local de entrega No caso do envio de documentos para entidades n√£o p√∫blicas (e.g envio de e-mail com PDF anexado), verificar se √© enviado um e-mail com a fatura ao destinat√°rio, e se a assinatura do documento XML √© desativada (caso seja usada uma assinatura digital qualificada no ilink)No caso da consulta de estado de documentos emitidos, dever√£o testar se o software √© capaz de receber e agir confirme o estado do documentoCaso o documento seja rejeitado/regularizado, dever√° ser poss√≠vel reenviar o mesmo com informa√ß√£o retificada.  Rece√ß√£o de documentos (no caso da implementa√ß√£o do fluxo de rece√ß√£o)  Devem verificar se um documento recebido √© corretamente integrado no software, e se √© comunicada a correta importa√ß√£o e aceita√ß√£o do mesmo.  Passagem a produ√ß√£o (obrigat√≥rio)  Configurar o URL de produ√ß√£o no vosso softwareSolicitar √† equipa do ilink o token de aplica√ß√£o e chave(s) da(s) entidade(s) do ambiente de produ√ß√£oAssegurar-se que s√£o efetuadas as autentica√ß√µes necess√°rias em ambiente produtivoAssegurar-se que o cliente tem todas as liga√ß√µes previamente configuradas no portal do ilink, assim como as transa√ß√µes necess√°rias ativas (solicitar ao servi√ßo de apoio)Opcional: assegurar que o cliente tem a assinatura digital corretamente configurada no ambiente produtivo.Opcional: assegurar que o cliente tem o template de envio de e-mail de fatura√ß√£o configurado no ambiente produtivo. ","version":"Next","tagName":"h2"}],"options":{"id":"default"}}